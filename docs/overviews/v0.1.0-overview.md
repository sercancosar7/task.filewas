# Task.filewas

> **Otonom AI Proje Gelistirme Platformu**

---

## Sunucu Bilgileri

| Bilgi | Deger |
|-------|-------|
| Domain | `task.filewas.com` |
| IP | `31.97.55.184` |
| API Port | `3001` |
| Frontend Port | `3000` (dev) / `80/443` (prod via nginx) |
| OS | Ubuntu 24.04 LTS |
| Platform Path | `/var/www/task.filewas/` |

### Servisler

| Servis | Yonetim | Aciklama |
|--------|---------|----------|
| Backend | PM2 | `pm2 restart task-filewas-backend` |
| Nginx | systemd | `systemctl status nginx` |

---

## Vizyon

```
"Proje fikrini anlat, gerisini AI halletsin."
```

| Adim | Aciklama |
|------|----------|
| 1 | Proje fikrini anlat |
| 2 | AI analiz eder, gereksinim toplar (chat ile) |
| 3 | Uygun agent/skill dosyalarini olusturur |
| 4 | Detayli roadmap cikarir |
| 5 | Faz faz otonom calisir |
| 6 | Her fazda test eder, hata varsa duzeltir |
| 7 | Tamamlanmis, test edilmis proje teslim eder |

---

## Temel Ozellikler

### UI - Craft Agents Tarzi (3 Panel Layout)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              â”‚               â”‚                        â”‚
â”‚   SIDEBAR    â”‚    INBOX      â”‚        CHAT            â”‚
â”‚ (180-320px)  â”‚  (240-480px)  â”‚       (flex-1)         â”‚
â”‚              â”‚               â”‚                        â”‚
â”‚ - Logo       â”‚ - Sessions    â”‚ - Messages (TurnCard)  â”‚
â”‚ - Proje      â”‚ - Filters     â”‚ - Input + Mode select  â”‚
â”‚ - Nav        â”‚ - Actions     â”‚ - Tool visualization   â”‚
â”‚ - Ayarlar    â”‚ - Status      â”‚ - Diff viewer          â”‚
â”‚              â”‚               â”‚                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

| Ozellik | Aciklama |
|---------|----------|
| 3 Panelli Layout | Sidebar, Session Inbox, Chat Area |
| Multi-Session Inbox | Ayni projede birden fazla session, filtreleme |
| Session Modlari | **Otonom:** Roadmap olustur â†’ fazlari otomatik bitir. **Manuel:** Tek tek ozellik/gorev sohbetiyle kodlattir |
| Session Statusleri | `Todo` â†’ `In Progress` â†’ `Needs Review` â†’ `Done` â†’ `Cancelled` |
| Permission Modes | `Safe (Explore)` \| `Ask` \| `Auto (Allow-all)` |
| Thinking Levels | `Off` \| `Think` \| `Max (Ultrathink)` |
| Multi-File Diff Viewer | VS Code tarzi degisiklik gorunumu |
| Drag & Drop | Dosya, resim, PDF destegi (limitsiz boyut) |
| Background Tasks | Progress tracking ile arka plan islemleri |
| Theme | Dark mode only (Craft Agents tarzi) |
| Notifications | Toast (in-app) bildirimleri |

---

## Chat Sayfasi Tasarim Detaylari

> **Referans:** Craft Agents UI stili. Resimden gÃ¶rsel tasarim ve stil alinir, icerik projemize uygun doldurulur.

### Renk Paleti (Craft Agents Dark Theme)

> **Kaynak:** `apps/electron/resources/themes/default.json` ve `index.css`
> **Renk Sistemi:** OKLCH (daha iyi renk gecisleri icin)

**Ana Renkler:**

| Degisken | Dark Mode | Light Mode | OKLCH | Kullanim |
|----------|-----------|------------|-------|----------|
| `--background` | `#1e1d21` | `#faf9fb` | `oklch(0.2 0.005 270)` | Ana arka plan |
| `--foreground` | `#f5f5f7` | `#1a1625` | `oklch(0.92 0.005 270)` | Ana metin |
| `--accent` | `#a78bfa` | `#8b5cf6` | `oklch(0.68 0.13 293)` | Primary accent (violet) |
| `--info` | `#fbbf24` | `#d97706` | `oklch(0.70 0.16 70)` | Info/warning (amber) |
| `--success` | `#22c55e` | `#16a34a` | `oklch(0.60 0.17 145)` | Success (green) |
| `--destructive` | `#ef4444` | `#dc2626` | `oklch(0.70 0.19 22)` | Error/danger (red) |

**Foreground Varyasyonlari (color-mix):**

```css
--foreground-1.5: color-mix(in oklch, var(--foreground) 1.5%, var(--background));
--foreground-2: color-mix(in oklch, var(--foreground) 2%, var(--background));
--foreground-5: color-mix(in oklch, var(--foreground) 5%, var(--background));
--foreground-7: color-mix(in oklch, var(--foreground) 7%, var(--background));
--foreground-10: color-mix(in oklch, var(--foreground) 10%, var(--background));
--foreground-30: color-mix(in oklch, var(--foreground) 30%, var(--background));
--foreground-40: color-mix(in oklch, var(--foreground) 40%, var(--background));
--foreground-60: color-mix(in oklch, var(--foreground) 60%, var(--background));
--foreground-95: color-mix(in oklch, var(--foreground) 95%, var(--background));
```

**Kullanim Ornekleri:**

| Tailwind Class | Kullanim |
|----------------|----------|
| `bg-foreground/[0.07]` | Button default background |
| `bg-foreground/2` | Card hover (unselected) |
| `bg-foreground/7` | Card hover (selected) |
| `bg-foreground/5` | Badge background |
| `bg-foreground/10` | Vertical line (nested items) |
| `text-foreground/30` | Label/badge text |
| `text-foreground/40` | Timestamp text |
| `text-foreground/60` | Icon default color |

**Shiki Syntax Themes:**
- Light: `github-light`
- Dark: `github-dark`

### Typography

| Element | Font | Size | Weight | Letter-spacing |
|---------|------|------|--------|----------------|
| Base | System UI / Inter | 15px | 400 | 0em |
| Body text | System UI | 13px | 400 | normal |
| Small text | System UI | 11px | 400 | normal |
| Badges | System UI | 10px | 500 | normal |
| Code | JetBrains Mono | 13px | 400 | normal |

**Font Family Stack:**
```css
--font-sans: ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";
--font-mono: "JetBrains Mono", ui-monospace, monospace;
```

**Optional Inter Font:**
```css
[data-font="inter"] { --font-sans: "Inter", ui-sans-serif, system-ui, sans-serif; }
```

### Layout & Spacing (Craft Agents Degerleri)

**Panel Boyutlari:**

| Panel | Min | Default | Max | Resize |
|-------|-----|---------|-----|--------|
| Left Sidebar | 180px | 220px | 320px | Draggable |
| Session List (Navigator) | 240px | 300px | 480px | Draggable |
| Main Content | - | flex-1 | - | Auto |
| Right Sidebar (overlay) | - | 300px | - | Fixed |

**Spacing Sabitleri:**

| Sabit | Deger | Kullanim |
|-------|-------|----------|
| `PANEL_WINDOW_EDGE_SPACING` | 6px | Window kenarlarindan padding |
| `PANEL_PANEL_SPACING` | 5px | Paneller arasi gap |
| Title bar offset | 50px | macOS title bar icin pt-[50px] |
| Overlay threshold | 600px + sidebars | Right sidebar overlay'e gecer |

**Tailwind Spacing:**

| Element | Class | Pixel |
|---------|-------|-------|
| Nav item padding | `py-[5px] px-2` | 5px 8px |
| Nav item compact | `py-[3px] px-2` | 3px 8px |
| Card padding | `py-3 pl-2 pr-4` | 12px 8px 12px 16px |
| Icon container | `h-3.5 w-3.5` | 14px |
| Nested indent | `pl-5` | 20px |
| Section gap | `gap-0.5` | 2px |
| Activity row gap | `gap-2` | 8px |

### Border Radius

| Element | Class | Pixel |
|---------|-------|-------|
| Buttons | `rounded-[6px]` | 6px |
| Cards | `rounded-[8px]` | 8px |
| Badges | `rounded` | 4px |
| Inputs | `rounded-lg` | 8px |

### Shadows

```css
--shadow-thin: 0 1px 2px rgba(0,0,0,0.05);
--shadow-minimal: 0 1px 3px rgba(0,0,0,0.1), 0 1px 2px rgba(0,0,0,0.06);
--shadow-middle: 0 4px 6px rgba(0,0,0,0.1), 0 2px 4px rgba(0,0,0,0.06);
--shadow-strong: 0 10px 15px rgba(0,0,0,0.1), 0 4px 6px rgba(0,0,0,0.05);
--shadow-modal-small: 0 4px 12px rgba(0,0,0,0.15);
```

### Z-Index Scale

| Layer | Value | Kullanim |
|-------|-------|----------|
| base | 0 | Normal content |
| panel | 50 | Floating panels |
| modal | 200 | Modals |
| overlay | 300 | Overlays |
| floating-menu | 400 | Dropdowns, popovers |
| splash | 600 | Loading screens |

---

### Sol Sidebar (Resizable: 180px â†” 320px, default 220px)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“ New Chat            â”‚  â† Primary action button
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ All Chats         (12) â”‚  â† Ana kategori
â”‚   â—‹ Backlog        (3) â”‚  â† Sortable (drag-drop)
â”‚   â—‹ Todo           (5) â”‚
â”‚   â—‰ In Progress    (1) â”‚
â”‚   â— Needs Review   (2) â”‚
â”‚   â— Done          (47) â”‚
â”‚   âŠ˜ Cancelled      (1) â”‚
â”‚                        â”‚
â”‚ ğŸš© Flagged         (2) â”‚  â† Ozel filtre
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â–¶ Sources              â”‚  â† Collapsible (chevron toggle)
â”‚   â†’ APIs               â”‚
â”‚   â†’ MCPs               â”‚
â”‚   â†’ Local Folders      â”‚
â”‚                        â”‚
â”‚ Skills                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ âš™ï¸ Settings            â”‚  â† mt-auto (alt kisimda sabit)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Tailwind Classes (Craft Agents):**

```tsx
// Nav Item Button
className="rounded-[6px] text-[13px] py-[5px] px-2
           hover:bg-sidebar-hover
           data-[state=open]:bg-sidebar-hover
           focus-visible:ring-1 focus-visible:ring-ring"

// Default variant
className="bg-foreground/[0.07]"

// Ghost variant (most items)
className="hover:bg-foreground/5"

// Icon container
className="h-3.5 w-3.5 shrink-0 flex items-center justify-center"

// Icon default color
style={{ color: "color-mix(in oklch, var(--foreground) 60%, transparent)" }}

// Label/badge
className="text-xs text-foreground/30 opacity-0 group-hover/section:opacity-100"

// Nested items
className="pl-5 pr-0"

// Vertical connector line
className="absolute left-[13px] w-px bg-foreground/10"

// Section gap
className="gap-0.5"
```

**Sidebar Structure:**

```tsx
<aside className="flex flex-col pt-[50px] shrink-0" style={{ width }}>
  {/* Top: Scrollable navigation */}
  <div className="flex-1 overflow-y-auto">
    <nav className="gap-0.5">
      {/* Navigation items */}
    </nav>
  </div>

  {/* Bottom: Fixed workspace/settings */}
  <div className="mt-auto">
    {/* Settings, workspace switcher */}
  </div>
</aside>
```

**Expandable Items (Chevron Toggle):**

- Chevron icon replaces main icon on hover
- Children render with stagger animation (0.025s delay)
- Height transition: 0.2s duration
- Keyboard navigation via parent component

**Drag-and-Drop (Status/Labels):**

- `SortableList` component for reordering
- DragOverlay portals to document.body
- Separators filtered from sortable items

**Status Icons & Colors:**

| Status | Icon | Renk | Tailwind |
|--------|------|------|----------|
| Backlog | â—‹ (Circle) | muted | `text-foreground/40` |
| Todo | â—‹ (Circle) | secondary | `text-foreground/60` |
| In Progress | â—‰ (CircleDot) | accent | `text-accent` |
| Needs Review | â— (CircleDashed) | info/amber | `text-info` |
| Done | â— (CheckCircle2) | success | `text-success` |
| Cancelled | âŠ˜ (XCircle) | muted | `text-foreground/40` |
| Flagged | ğŸš© (Flag) | info | `text-info` |

---

### Orta Panel - Session Inbox (Navigator: 240-480px, default 300px)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ All Chats                    â‰¡   â”‚  â† PanelHeader + filter icon
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ” Search sessions...        â”‚ â”‚  â† SessionSearchHeader
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ TODAY                            â”‚  â† Date group header
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ â—‰ E-commerce checkout flow   â”‚ â”‚  â† SessionItem (active)
â”‚ â”‚   â³ Processing Â· 4m ago     â”‚ â”‚
â”‚ â”‚   [ğŸ”“Auto] [Planning] [glm]  â”‚ â”‚  â† Badge row (scrollable)
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ â— Auth sistem refactor       â”‚ â”‚  â† SessionItem (done)
â”‚ â”‚   âœ“ 2 hours ago              â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                  â”‚
â”‚ YESTERDAY                        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ â—‹ API endpoint design        â”‚ â”‚  â† SessionItem (todo)
â”‚ â”‚   ğŸ“‹ Yesterday               â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Session Item Structure (Craft Agents):**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [Status] Title                              [Action Btns]  â”‚  â† Row 1
â”‚          â†³ absolute positioned               â†³ abs right   â”‚
â”‚                                                            â”‚
â”‚ [Badges Row - Scrollable with fade mask]     [Timestamp]  â”‚  â† Row 2
â”‚ [Spinner][New][Flag][Plan][Mode][Labels...] â”‚  shrink-0   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Tailwind Classes (Craft Agents):**

```tsx
// Session Item Container
className="session-item relative group select-none pl-2 mr-2"

// Session Button
className="flex w-full items-start gap-2 pl-2 pr-4 py-3
           text-left text-sm rounded-[8px]
           hover:bg-foreground/2 data-[selected]:bg-foreground/5
           data-[selected]:hover:bg-foreground/7"

// Title (with shimmer animation during async)
className="animate-shimmer-text"  // when processing

// Badge Row (scrollable with fade)
className="overflow-x-auto scrollbar-hide"
style={{ mask: "linear-gradient(to right, black calc(100% - 16px), transparent 100%)" }}

// Individual Badge
className="h-[18px] px-1.5 text-[10px] font-medium rounded"

// Unread Badge
className="px-1.5 py-0.5 text-[10px] rounded bg-accent text-white"

// Flag Icon Container
className="h-[18px] w-[18px] flex bg-foreground/5 rounded"

// Plan Badge
className="h-[18px] px-1.5 text-success rounded bg-success/10"

// Timestamp
className="shrink-0 text-[11px] text-foreground/40 whitespace-nowrap"

// Action buttons (hover reveal)
className="group-hover:opacity-100 opacity-0"
```

**Session Card Badges (Subtitle Row):**

| Badge | Kosul | Stil |
|-------|-------|------|
| Processing Spinner | isProcessing | `text-[8px] shrink-0` |
| Unread | hasUnread | `bg-accent text-white px-1.5` |
| Flag | isFlagged | `h-[18px] w-[18px] bg-foreground/5` |
| Plan | hasPlan | `text-success bg-success/10` |
| Permission Mode | always | Varies by mode (see below) |
| Labels | hasLabels | `max-w-[120px]` with custom color |
| Share | isShared | `bg-foreground/5` with CloudUpload icon |

**Permission Mode Badges:**

| Mode | Badge Text | Stil |
|------|------------|------|
| Safe | ğŸ” Safe | `bg-accent/10 text-accent` |
| Ask | â“ Ask | `bg-info/10 text-info` |
| Auto | ğŸ”“ Auto | `bg-success/10 text-success` |

**Session Card Icerik (Kullanici Gorunumu):**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [Status Icon] Session Title        â”‚
â”‚   [Mode Icon] Mode Â· Time ago      â”‚
â”‚   Phase X/Y Â· model-name           â”‚  â† Otonom calisiyorsa gosterilir
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Chat Mode Icons & Aciklamalar:**

| Mode | Icon | Lucide | Aciklama |
|------|------|--------|----------|
| Quick Chat | ğŸ’¬ | `MessageSquare` | Tek seferlik hizli gorev |
| Planning | ğŸ¤– | `Bot` / `ListTodo` | Complex proje planlama |
| TDD | ğŸ§ª | `TestTube2` | Test-driven development |
| Debug | ğŸ› | `Bug` | Hata ayiklama |
| Code Review | ğŸ‘ï¸ | `Eye` / `GitPullRequest` | Kod inceleme |

---

### Sag Panel - Chat Area (MainContentPanel: flex-1)

> **Component:** `ChatDisplay.tsx`, `TurnCard.tsx`, `SessionViewer.tsx`

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ E-commerce checkout flow                              â–¼  [â‹®]      â”‚  â† Header
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                    â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚                      MESAJ ALANI                                â”‚ â”‚
â”‚ â”‚                      (scrollable)                               â”‚ â”‚
â”‚ â”‚                                                                 â”‚ â”‚
â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚ â”‚  â”‚ [User Turn Card]                                        â”‚   â”‚ â”‚
â”‚ â”‚  â”‚ "Odeme sistemi ekle, Stripe kullan"                     â”‚   â”‚ â”‚
â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚ â”‚                                                                 â”‚ â”‚
â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚ â”‚  â”‚ [Assistant Turn Card - Collapsible]                     â”‚   â”‚ â”‚
â”‚ â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚ â”‚
â”‚ â”‚  â”‚ â”‚ â–¼ 12 steps Â· Read, Edit, Bash...    (Activity)    â”‚   â”‚   â”‚ â”‚
â”‚ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚ â”‚
â”‚ â”‚  â”‚ â”‚  âœ“ Todo List Updated                              â”‚   â”‚   â”‚ â”‚
â”‚ â”‚  â”‚ â”‚  ğŸ“– Read src/components/Checkout.tsx              â”‚   â”‚   â”‚ â”‚
â”‚ â”‚  â”‚ â”‚  âœï¸ Edit src/services/payment.ts                  â”‚   â”‚   â”‚ â”‚
â”‚ â”‚  â”‚ â”‚  â¬¡ Bash npm install stripe                        â”‚   â”‚   â”‚ â”‚
â”‚ â”‚  â”‚ â”‚  ...                                              â”‚   â”‚   â”‚ â”‚
â”‚ â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚ â”‚
â”‚ â”‚  â”‚ â”‚ Response Card (Markdown)                          â”‚   â”‚   â”‚ â”‚
â”‚ â”‚  â”‚ â”‚ "Stripe entegrasyonu tamamlandi. Yapilan..."      â”‚   â”‚   â”‚ â”‚
â”‚ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚ â”‚
â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚ â”‚                                                                 â”‚ â”‚
â”‚ â”‚  â³ Calisiyor... 4:32                                           â”‚ â”‚
â”‚ â”‚                                                                 â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                         INPUT AREA                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ ğŸ”“ Auto â–¼                                                     â”‚   â”‚  â† Permission mode dropdown
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ Mesajinizi yazin...                                          â”‚   â”‚
â”‚ â”‚                                                    âœˆï¸ Send    â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚ ğŸ“ Attach  ğŸ’¬ Quick Chat â–¼  ğŸ“ my-project       Claude â–¼  â˜ Think â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### TurnCard Component (Craft Agents Pattern)

> **Email-like collapsible interface** for assistant turns.

**Structure:**

```
â”Œâ”€ TurnCard â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                      â”‚
â”‚  â”Œâ”€ Activity Section (Collapsible) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ â–¼ [Badge: 12 steps] Preview text...              (Header)      â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ â”‚  âœ“ Todo List Updated                           (Expanded)    â”‚ â”‚
â”‚  â”‚ â”‚  ğŸ“– Read src/components/Checkout.tsx                         â”‚ â”‚
â”‚  â”‚ â”‚  âœï¸ Edit src/services/payment.ts                             â”‚ â”‚
â”‚  â”‚ â”‚  â¬¡ Bash npm install stripe                                   â”‚ â”‚
â”‚  â”‚ â”‚  ... (scrollable if > 14 items)                              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                      â”‚
â”‚  â”Œâ”€ Response Section (Always visible when complete) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Markdown rendered response                                      â”‚ â”‚
â”‚  â”‚ Code blocks with syntax highlighting                            â”‚ â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚ â”‚ Footer actions (Copy, Accept Plan, etc.)                   â”‚ â”‚ â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**SIZE_CONFIG (Craft Agents):**

```typescript
const SIZE_CONFIG = {
  typography: "text-[13px]",
  iconSize: "w-3 h-3",
  maxVisibleActivities: 14,  // Scroll triggers after this
}
```

**Tailwind Classes:**

```tsx
// TurnCard container
className="space-y-1"

// Activity Header
className="rounded-[8px] shadow-minimal text-muted-foreground"

// Chevron rotation (Framer Motion)
animate={{ rotate: isExpanded ? 90 : 0 }}

// Activity list (expanded)
className="border-l-2 border-muted ml-[13px] pl-4 pr-2 py-0"

// Activity row
className="gap-2 py-0.5"

// Staggered animation
transition={{ delay: index * 0.03 }}  // 30ms stagger

// Response card
className="rounded-[8px] shadow-minimal"
```

**Variants:**

| Variant | Header Icon | Footer Actions |
|---------|-------------|----------------|
| Response | - | Copy, Feedback |
| Plan | `ListTodo` | Accept Plan dropdown |

---

### Activity Row (Tool Visualization)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [Icon] [Tool Name]  [Detail/Path]                      [Time]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Tool Icons (Lucide):**

| Tool | Icon | Renk | Lucide Component |
|------|------|------|------------------|
| Read | ğŸ“– | `text-accent` | `FileText` |
| Write | âœï¸ | `text-success` | `FilePlus` |
| Edit | âœï¸ | `text-info` | `FileEdit` / `Pencil` |
| Bash | â¬¡ | `text-accent` | `Terminal` |
| Glob | ğŸ” | `text-muted-foreground` | `Search` |
| Grep | ğŸ” | `text-muted-foreground` | `FileSearch` |
| Task | ğŸ¤– | `text-accent` | `Bot` |
| WebFetch | ğŸŒ | `text-accent` | `Globe` |
| TodoWrite | âœ“ | `text-success` | `CheckSquare` |

**Tailwind Classes:**

```tsx
// Activity row container
className="flex items-center gap-2 py-0.5 text-[13px]"

// Icon
className="w-3 h-3 shrink-0"

// Tool name
className="font-medium shrink-0"

// Detail/Path (clickable)
className="text-accent truncate cursor-pointer hover:underline"

// Time
className="text-muted-foreground text-[11px] ml-auto shrink-0"
```

---

### Todo List Widget (Inline)

> Craft Agents'ta TodoWrite tool'u `Todo List Updated` olarak gosterilir.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Todo List                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â˜‘ Stripe SDK kurulumu                     (completed)          â”‚
â”‚ â˜‘ Payment service olustur                 (completed)          â”‚
â”‚ â–£ Checkout UI implement et                (in_progress)        â”‚
â”‚ â˜ Error handling ekle                     (pending)            â”‚
â”‚ â˜ Unit test yaz                           (pending)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Tailwind Classes:**

```tsx
// Container
className="bg-foreground/5 rounded-[8px] p-3"

// Header
className="text-[13px] font-medium text-muted-foreground mb-2"

// Item row
className="flex items-center gap-2 py-1 text-[13px]"

// Completed item
className="line-through text-muted-foreground"

// In progress item
className="text-accent font-medium"

// Pending item
className="text-foreground/80"
```

| Durum | Icon | Stil |
|-------|------|------|
| Completed | `CheckSquare` | `line-through text-muted-foreground` |
| In Progress | `Square` (filled) | `text-accent font-medium` |
| Pending | `Square` (empty) | `text-foreground/80` |

---

### Progress Indicator (Streaming State)

```
â³ Calisiyor... 4:32
```

veya (faz bilgisiyle):

```
â³ Phase 3/12: Checkout UI Â· glm Â· 4:32
```

**Animations (Craft Agents):**

```css
@keyframes spinner-grid {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

@keyframes shimmer {
  0% { background-position: -200% 0; }
  100% { background-position: 200% 0; }
}
```

**Tailwind Classes:**

```tsx
// Spinner container
className="flex items-center gap-2 text-[13px] text-muted-foreground"

// Spinner icon
className="animate-spin h-4 w-4"

// Timer (monospace)
className="font-mono text-[11px]"
```

---

### Input Area (Craft Agents Pattern)

> **Layout:** Permission dropdown Ã¼stte, input ortada, toolbar altta

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ ğŸ”“ Auto â–¼                                                     â”‚   â”‚  â† AcceptPlanDropdown
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ Mesajinizi yazin...                                    âœˆï¸    â”‚   â”‚  â† Textarea + Send button
â”‚ â”‚                                                               â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚ ğŸ“  ğŸ’¬ Quick Chat â–¼  ğŸ“ my-project              Claude â–¼  â˜ Think â”‚  â† Toolbar
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Permission Mode Dropdown (AcceptPlanDropdown pattern):**

```tsx
// Dropdown trigger button
className="flex items-center gap-2 px-3 py-2 rounded-[8px]
           text-[13px] font-medium
           bg-foreground/5 hover:bg-foreground/10"
```

| Mode | Icon | Badge Style | Aciklama |
|------|------|-------------|----------|
| Safe | `Search` | `bg-accent/10 text-accent` | Salt okunur, SubmitPlan ile plan sunar |
| Ask | `HelpCircle` | `bg-info/10 text-info` | Her islemde onay sorar |
| Auto | `Unlock` | `bg-success/10 text-success` | Tam otonom yurutme |

**Chat Mode Dropdown:**

| Mode | Icon | Lucide | Aciklama |
|------|------|--------|----------|
| Quick Chat | ğŸ’¬ | `MessageSquare` | Tek seferlik hizli gorev |
| Planning | ğŸ¤– | `Bot` / `ListTodo` | Complex proje planlama |
| TDD | ğŸ§ª | `TestTube2` | Test-driven development |
| Debug | ğŸ› | `Bug` | Hata ayiklama |
| Code Review | ğŸ‘ï¸ | `Eye` | Kod inceleme |

**Model Selector:**

```tsx
// Dropdown items
<DropdownMenuItem>
  <RadioGroupItem /> Auto (agent'a gore)
</DropdownMenuItem>
<DropdownMenuItem>
  <RadioGroupItem /> Claude (Opus 4.5)
</DropdownMenuItem>
<DropdownMenuItem>
  <RadioGroupItem /> GLM (4.7)
</DropdownMenuItem>
```

**Thinking Level Toggle:**

| State | Display | Aciklama |
|-------|---------|----------|
| Off | `â˜ Think` | Normal yanit |
| Think | `â˜‘ Think` | Extended thinking |
| Max | `â˜‘â˜‘ Max` | Ultrathink (shift+click) |

**Input Tailwind Classes:**

```tsx
// Input container
className="relative flex flex-col gap-2 p-3
           bg-background border border-foreground/10
           rounded-[12px] focus-within:border-accent"

// Textarea
className="min-h-[44px] max-h-[200px] resize-none
           bg-transparent text-[15px] placeholder:text-muted-foreground
           focus:outline-none"

// Send button
className="absolute right-3 bottom-3
           p-2 rounded-[8px] bg-accent text-white
           hover:bg-accent/90 disabled:opacity-50"

// Toolbar
className="flex items-center gap-3 px-1 text-[13px]"

// Toolbar button (ghost)
className="flex items-center gap-1.5 px-2 py-1
           rounded-[6px] text-muted-foreground
           hover:bg-foreground/5 hover:text-foreground"
```

---

### User Message (Turn Card - User variant)

> Craft Agents'ta user mesajlari da TurnCard icinde gosterilir, bubble degil.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Odeme sistemi ekle, Stripe kullanarak checkout flow implement  â”‚
â”‚ et. Test yazmayÄ± unutma.                                       â”‚
â”‚                                                    [Edit] [â‹®]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Tailwind Classes:**

```tsx
// User turn container
className="bg-foreground/5 rounded-[8px] p-4 text-[15px]"

// Edit button (hover reveal)
className="opacity-0 group-hover:opacity-100"
```

---

### Assistant Response (TurnCard - Response variant)

> Response card her zaman activity section'dan sonra gosterilir.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Stripe entegrasyonu tamamlandi. YapÄ±lan islemler:              â”‚
â”‚                                                                 â”‚
â”‚ - `stripe` ve `@stripe/stripe-js` paketleri yuklendi           â”‚
â”‚ - `usePayment` hook'u olusturuldu                              â”‚
â”‚ - `CheckoutForm` component'i guncellendi                       â”‚
â”‚                                                                 â”‚
â”‚ ```typescript                                                   â”‚
â”‚ const { confirmPayment } = usePayment()                        â”‚
â”‚ await confirmPayment(clientSecret)                             â”‚
â”‚ ```                                                             â”‚
â”‚                                                    [Copy] [ğŸ‘] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Tailwind Classes:**

```tsx
// Response card
className="bg-foreground/5 rounded-[8px] p-4 shadow-minimal"

// Markdown content
className="prose prose-sm prose-invert max-w-none
           prose-headings:text-foreground
           prose-p:text-foreground/90
           prose-code:bg-foreground/10 prose-code:rounded
           prose-pre:bg-background prose-pre:border prose-pre:border-foreground/10"

// Code block (Shiki)
className="text-[13px] font-mono rounded-[8px] p-4 overflow-x-auto"

// Footer actions
className="flex items-center gap-2 mt-3 pt-3 border-t border-foreground/10"

// Action button
className="p-1.5 rounded-[6px] text-muted-foreground
           hover:bg-foreground/10 hover:text-foreground"
```

**Streaming Animation:**

```tsx
// Smooth text fade during streaming
<motion.div
  animate={{ opacity: isStreaming ? [0.7, 1] : 1 }}
  transition={{ duration: 0.3 }}
>
  {content}
</motion.div>
```

---

### Diff Viewer (Modal veya Inline)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Changes (3 files)                                    [Ã—] Close â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”œâ”€â”€ src/components/CheckoutForm.tsx        +45 -12            â”‚
â”‚ â”œâ”€â”€ src/services/payment.ts                +78 -0             â”‚
â”‚ â””â”€â”€ src/hooks/usePayment.ts                +34 -0  (new)      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ src/components/CheckoutForm.tsx                            â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚  42 â”‚ - const handleSubmit = () => {                       â”‚ â”‚
â”‚ â”‚     â”‚ + const handleSubmit = async () => {                 â”‚ â”‚
â”‚ â”‚  43 â”‚ +   const { error } = await stripe.confirmPayment()  â”‚ â”‚
â”‚ â”‚  44 â”‚ +   if (error) setError(error.message)               â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

| Element | Stil |
|---------|------|
| Added line | background: `bg-success/10`, prefix: `+` green |
| Removed line | background: `bg-destructive/10`, prefix: `-` red |
| Line number | `text-muted-foreground`, monospace |
| File header | `bg-foreground/5`, 13px, font-weight: 500 |
| Stats | `+45` text-success, `-12` text-destructive |

---

### Toast Notifications

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ“ Faz 3 tamamlandi              [Ã—] â”‚
â”‚   Checkout UI implement edildi      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

| Type | Icon | Border-left Color |
|------|------|-------------------|
| Success | âœ“ | `text-success` / `bg-success` |
| Error | âœ— | `text-destructive` / `bg-destructive` |
| Warning | âš  | `text-info` / `bg-info` |
| Info | â„¹ | `text-accent` / `bg-accent` |

| Element | Stil |
|---------|------|
| Position | bottom-right |
| Background | `bg-background` with tinted variant |
| Border-left | 3px solid (type color) |
| Padding | 12px 16px |
| Border-radius | `rounded-[8px]` |
| Shadow | `shadow-modal-small` |
| Auto-dismiss | 5 saniye |

**Sonner Toast Customization (Craft Agents):**
```css
[data-sonner-toast] {
  --normal-bg: var(--background);
  --success-bg: color-mix(in oklch, var(--success) 15%, var(--background));
  --error-bg: color-mix(in oklch, var(--destructive) 15%, var(--background));
  --info-bg: color-mix(in oklch, var(--info) 15%, var(--background));
}
```

---

### Responsive Davranis

| Breakpoint | Davranis |
|------------|----------|
| < 768px | Sidebar hidden, Inbox full width, Chat overlay |
| 768-1024px | Sidebar collapsed (60px), Inbox 250px |
| > 1024px | Full 3 panel layout |

---

### Keyboard Shortcuts

| Shortcut | Islem | Aciklama |
|----------|-------|----------|
| `Cmd/Ctrl + Enter` | Mesaj gonder | Chat input'tan mesaj gonder |
| `Cmd/Ctrl + K` | Command palette | Hizli komut arama |
| `Cmd/Ctrl + N` | Yeni session | Yeni chat session'i olustur |
| `Cmd/Ctrl + P` | Proje degistir | Projeler arasi gecis |
| `Cmd/Ctrl + B` | Sidebar toggle | Sidebar'i gizle/goster |
| `Cmd/Ctrl + Shift + S` | Ayarlar | Settings modal ac |
| `Cmd/Ctrl + /` | Shortcut help | Kisayol listesini goster |
| `Escape` | Iptal | Modal kapat, input temizle |
| `Cmd/Ctrl + .` | Stop generation | AI yanit olusturmayi durdur |
| `Cmd/Ctrl + Shift + D` | Diff viewer | Multi-file diff gorunumu |
| `Up Arrow` | Onceki mesaj | Input'ta onceki mesaji getir |
| `Tab` | Autocomplete | Komut/mention tamamlama |

### Sayfa Yapisi

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        TASK.FILEWAS                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         â”‚                                                       â”‚
â”‚ SIDEBAR â”‚              MAIN CONTENT                             â”‚
â”‚  (60px) â”‚                                                       â”‚
â”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â” â”‚  â”‚ Dashboard / Project View / Settings / ...       â”‚  â”‚
â”‚ â”‚ ğŸ   â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚ â”‚ ğŸ“  â”‚ â”‚                                                       â”‚
â”‚ â”‚ ğŸ’¬  â”‚ â”‚                                                       â”‚
â”‚ â”‚ ğŸ¤–  â”‚ â”‚                                                       â”‚
â”‚ â”‚ âš¡  â”‚ â”‚                                                       â”‚
â”‚ â”‚ ğŸ”Œ  â”‚ â”‚                                                       â”‚
â”‚ â”‚ ğŸ“‹  â”‚ â”‚                                                       â”‚
â”‚ â”‚ âš™ï¸  â”‚ â”‚                                                       â”‚
â”‚ â””â”€â”€â”€â”€â”€â”˜ â”‚                                                       â”‚
â”‚         â”‚                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Sidebar Navigation

| Icon | Sayfa | Path | Aciklama |
|------|-------|------|----------|
| ğŸ  | Dashboard | `/` | Ana sayfa, stats, activity |
| ğŸ“ | Projeler | `/projects` | Proje listesi |
| ğŸ’¬ | Sessions | `/sessions` | Tum session'lar (proje bagimsiz) |
| ğŸ¤– | Agents | `/agents` | Agent listesi ve ayarlari |
| âš¡ | Skills | `/skills` | Skill listesi ve ayarlari |
| ğŸ”Œ | Sources | `/sources` | MCP, API, Local kaynaklar |
| ğŸ“‹ | Logs | `/logs` | Sistem loglari |
| âš™ï¸ | Ayarlar | `/settings` | Genel ayarlar |

### Dashboard (Ana Sayfa)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Dashboard                                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ Projeler    â”‚ â”‚ Sessions    â”‚ â”‚ Bugun       â”‚ â”‚ Agent       â”‚â”‚
â”‚ â”‚     12      â”‚ â”‚     47      â”‚ â”‚   3 faz     â”‚ â”‚  Claude: 8  â”‚â”‚
â”‚ â”‚   toplam    â”‚ â”‚   aktif     â”‚ â”‚ tamamlandi  â”‚ â”‚  GLM: 23    â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ Son Projeler                 â”‚ â”‚ Activity Feed               â”‚â”‚
â”‚ â”‚                              â”‚ â”‚                             â”‚â”‚
â”‚ â”‚ â€¢ task.filewas (aktif)       â”‚ â”‚ â€¢ 10:23 - Faz 3 tamamlandi  â”‚â”‚
â”‚ â”‚ â€¢ e-commerce-app             â”‚ â”‚ â€¢ 10:15 - Test passed       â”‚â”‚
â”‚ â”‚ â€¢ mobile-dashboard           â”‚ â”‚ â€¢ 10:02 - Kod yazildi       â”‚â”‚
â”‚ â”‚                              â”‚ â”‚ â€¢ 09:45 - Session basladi   â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ Quick Actions                                                 â”‚â”‚
â”‚ â”‚ [+ Yeni Proje] [+ Yeni Session] [Import GitHub]              â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

| Widget | Icerik |
|--------|--------|
| Stats Cards | Proje sayisi, aktif session, bugunun fazlari, model kullanimi |
| Son Projeler | Son 5 proje, quick access |
| Activity Feed | Son aktiviteler (faz, test, session, commit) |
| Quick Actions | Yeni proje, yeni session, GitHub import butonlari |

### Proje Detay Sayfalari (Tabs)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“ task.filewas                                    [âš™ï¸] [GitHub]â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [Sessions] [Roadmap] [Files] [Changelog] [Settings]            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚                    TAB CONTENT                                  â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

| Tab | Path | Icerik |
|-----|------|--------|
| Sessions | `/projects/:id` | Session inbox (3 panel layout) |
| Roadmap | `/projects/:id/roadmap` | Faz listesi, milestone'lar, ilerleme |
| Files | `/projects/:id/files` | Proje dosya yapisi, file browser |
| Changelog | `/projects/:id/changelog` | Degisiklik gecmisi |
| Settings | `/projects/:id/settings` | Proje-ozel ayarlar |

### Ayarlar Sayfasi

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âš™ï¸ Ayarlar                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                             â”‚
â”‚ â”‚ Model           â”‚ Default model, agent mapping, fallback      â”‚
â”‚ â”‚ Theme           â”‚ Dark mode (sabit)                           â”‚
â”‚ â”‚ Shortcuts       â”‚ Keyboard shortcut'lari goster/duzenle       â”‚
â”‚ â”‚ Fallback        â”‚ Fallback chain enable/disable               â”‚
â”‚ â”‚ Permission      â”‚ Default permission mode                     â”‚
â”‚ â”‚ Agent Defaults  â”‚ Her agent icin default model                â”‚
â”‚ â”‚ GitHub          â”‚ GitHub account, auto-push ayarlari          â”‚
â”‚ â”‚ Backup          â”‚ Backup stratejisi ayarlari                  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                             â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

| Bolum | Ayarlar |
|-------|---------|
| Model | Default model (claude/glm/auto), thinking level default |
| Fallback | Enable/disable, fallback order |
| Permission | Default permission mode (Safe/Ask/Auto) |
| Agent Defaults | Her agent icin default model override |
| GitHub | Account baglama, auto-push on/off, branch strategy |
| Backup | Backup frequency, backup location |

### Session Workflow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Todo  â”‚â”€â”€â”€â–¶â”‚ In Progress â”‚â”€â”€â”€â–¶â”‚ Needs Review â”‚â”€â”€â”€â–¶â”‚  Done  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                          â”‚
                                                          â–¼
                                                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                   â”‚ Cancelled â”‚
                                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Session Statusleri (Built-in + Custom):**

| Status | Icon | Aciklama |
|--------|------|----------|
| `todo` | â—‹ | Bekleyen gorevler |
| `in-progress` | â—‰ | Aktif calisilan |
| `needs-review` | â— | Inceleme bekleyen |
| `done` | â— | Tamamlanan |
| `cancelled` | âŠ˜ | Iptal edilen |
| Custom | ? | Kullanici tanimli statusler |

### Permission Modes

| Mod | Davranis | Kullanim |
|-----|----------|----------|
| **Safe (Explore)** | Salt okunur, plan SubmitPlan ile sunulur | Kesfetme, analiz |
| **Ask** | Duzenlemeler oncesi uyari/onay | Normal gelistirme |
| **Auto (Allow-all)** | Tam otonom yurutme | Guvenilen gorevler |

### Thinking Levels

| Level | Aciklama | Kullanim |
|-------|----------|----------|
| `off` | Normal yanit | Basit gorevler |
| `think` | Extended thinking | Complex problemler |
| `max` | Ultrathink (maksimum reasoning) | Mimari kararlar |

### Everything Claude Code Entegrasyonu

> **Kaynak:** https://github.com/affaan-m/everything-claude-code

#### ECC Dosya Yapisi

```
task.filewas/
â”œâ”€â”€ CLAUDE.md                 # PLATFORM KURALLARI (task.filewas icin)
â”‚
â”œâ”€â”€ .task/                    # SABIT ECC DOSYALARI (tum projelerde ayni)
â”‚   â”œâ”€â”€ agents/               # Agent tanimlari (*.md)
â”‚   â”‚   â”œâ”€â”€ orchestrator.md
â”‚   â”‚   â”œâ”€â”€ planner.md
â”‚   â”‚   â”œâ”€â”€ architect.md
â”‚   â”‚   â”œâ”€â”€ implementer.md
â”‚   â”‚   â”œâ”€â”€ reviewer.md
â”‚   â”‚   â”œâ”€â”€ tester.md
â”‚   â”‚   â”œâ”€â”€ security.md
â”‚   â”‚   â””â”€â”€ debugger.md
â”‚   â”œâ”€â”€ skills/               # Skill sablonlari (**/*.md)
â”‚   â”œâ”€â”€ hooks/                # hooks.json
â”‚   â””â”€â”€ commands/             # Slash komutlari (*.md)
â”‚
â””â”€â”€ projects/
    â””â”€â”€ proje-adi/
        â”œâ”€â”€ CLAUDE.md         # PROJE-OZEL KURALLAR
        â”‚                     # - Proje hakkinda bilgi
        â”‚                     # - Tech stack, yapilar
        â”‚                     # - Proje-spesifik kurallar
        â”œâ”€â”€ .task/            # .task/'tan OTOMATIK KOPYALANIR
        â”‚                     # (proje olusturulurken)
        â””â”€â”€ docs/
            â””â”€â”€ v0.1.0/
                â”œâ”€â”€ overview.md
                â”œâ”€â”€ roadmap.jsonl
                â””â”€â”€ changelog.jsonl
```

**Onemli:**
- `.task/` klasoru **sabit** - tum projelerde ayni dosyalar
- Proje olusturulurken `.task/` otomatik kopyalanir
- Her projenin kendi `CLAUDE.md` dosyasi var (proje-ozel kurallar)
- Agent'lar zamanla guncellenebilir, guncellemeler tum projelere yansir

#### CLAUDE.md Hiyerarsisi

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CLAUDE.MD HIYERARSISI                                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚ ~/.claude/rules/*.md        â†’ GLOBAL KURALLAR                           â”‚
â”‚                               (Sunucudaki tum Claude kullanimi icin)    â”‚
â”‚                                                                          â”‚
â”‚ /var/www/task.filewas/      â†’ PLATFORM KURALLARI                        â”‚
â”‚ CLAUDE.md                     "Sen task.filewas platformunda            â”‚
â”‚                               calisiyorsun"                             â”‚
â”‚                                                                          â”‚
â”‚ projects/proje-adi/         â†’ PROJE KURALLARI                           â”‚
â”‚ CLAUDE.md                     "Bu proje X teknolojisi kullaniyor,       â”‚
â”‚                               Y pattern'i izle"                         â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Claude Code CLI hangi dosyalari okur:**
- `~/.claude/rules/*.md` (global rules)
- Calistirildigi dizindeki `CLAUDE.md` (proje root)

**Proje-ozel kurallar:** `CLAUDE.md`'de genel kurallar, detayli proje bilgileri inject edilen `overview.md` ve `roadmap.jsonl`'de.

#### ECC Dosyalari Nasil Kullanilir

| Dosya Tipi | Konum | Kullanim |
|------------|-------|----------|
| **Agents** | `.task/agents/*.md` | `Task` tool ile subagent spawn |
| **Skills** | `.task/skills/**/*.md` | `/skill-name` komutu ile cagir |
| **Commands** | `.task/commands/*.md` | `/command-name` slash komutu |
| **Hooks** | `.task/hooks/hooks.json` | Otomatik tetiklenir (pre/post tool) |
| **Rules** | `~/.claude/rules/*.md` | Her zaman aktif (global) |
| **Contexts** | `~/.claude/contexts/*.md` | Context mode ile aktif |

**Agent Kullanimi (Backend'de):**
```typescript
// Agent dosyasini oku
const agentMd = readFileSync('.task/agents/planner.md', 'utf-8');

// YAML frontmatter parse et
const { name, tools, model } = parseAgentFrontmatter(agentMd);

// System prompt olarak kullan
const proc = spawn(model === 'opus' ? 'claude' : 'glm', [
  '-p',
  '--system-prompt', agentMd,  // Tum agent.md icerigi
  '--output-format', 'stream-json'
], { cwd: projectDir });
```

**Skill/Command Kullanimi:**
- Kullanici UI'dan `/plan` yazdiginda â†’ `commands/plan.md` okunur
- Icerik prompt'a eklenir ve Claude'a gonderilir

#### Memory MCP Kullanimi

> **memory.json dosyasi YOK.** Memory MCP kullaniliyor.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MEMORY MCP                                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚ Veri Yapisi: Knowledge Graph (Entity â†’ Relation â†’ Observation)          â”‚
â”‚ Dosya: memory.jsonl (MEMORY_FILE_PATH ile degistirilebilir)             â”‚
â”‚                                                                          â”‚
â”‚ TOOL'LAR:                                                               â”‚
â”‚ - mcp__memory__create_entities     â†’ Yeni entity olustur                â”‚
â”‚ - mcp__memory__create_relations    â†’ Entity'ler arasi iliski            â”‚
â”‚ - mcp__memory__add_observations    â†’ Entity'ye bilgi ekle               â”‚
â”‚ - mcp__memory__search_nodes        â†’ Bilgi ara                          â”‚
â”‚ - mcp__memory__read_graph          â†’ Tum graph'i oku                    â”‚
â”‚ - mcp__memory__open_nodes          â†’ Belirli entity'leri ac             â”‚
â”‚ - mcp__memory__delete_*            â†’ Silme islemleri                    â”‚
â”‚                                                                          â”‚
â”‚ PROJE BILGILERI NASIL SAKLANIR:                                         â”‚
â”‚                                                                          â”‚
â”‚ Entity: "task-filewas-v0.1.0"                                           â”‚
â”‚ Type: "project-version"                                                  â”‚
â”‚ Observations:                                                            â”‚
â”‚   - "JWT authentication kullaniliyor"                                   â”‚
â”‚   - "Radix UI tercih edildi"                                            â”‚
â”‚   - "Rate limit icin exponential backoff eklendi"                       â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Agent Memory Kullanimi:**
```typescript
// Agent prompt'unda Memory MCP'ye erisim var
// Agent gerektiginde kendisi sorgular:

// Proje kararlarini sorgula
mcp__memory__search_nodes("task-filewas kararlari")

// Yeni karar ekle
mcp__memory__add_observations({
  entityName: "task-filewas-v0.1.0",
  contents: ["WebSocket icin Socket.io kullaniliyor"]
})
```

| Format | Dosya | Kullanim |
|--------|-------|----------|
| Agent | `agents/*.md` | AI rolleri, araclari, model secimi |
| Skill | `skills/**/*.md` | Is akisi sablonlari |
| Hook | `hooks/hooks.json` | Event-based otomasyon |
| Command | `commands/*.md` | Slash komutlari |
| Memory | Memory MCP | Proje kararlari, dersler (dosya degil, tool) |

### Chat Modlari (Input Dropdown)

| Mod | Kullanim | Ornek |
|-----|----------|-------|
| Quick Chat | Tek seferlik, hizli gorevler | "Bu dosyayi duzelt" |
| Planning Mode | Complex proje planlamasi | Roadmap olusturma |
| Code Review | Kod inceleme ve oneri | PR review |
| TDD Mode | Test-driven development akisi | Test â†’ Kod â†’ Refactor |
| Debug Mode | Hata ayiklama odakli | Stack trace analizi |

### Sources (Veri Kaynaklari)

Agent'larin erisebilecegi harici veri kaynaklari:

| Kaynak Tipi | Aciklama | Ornek |
|-------------|----------|-------|
| **MCP** | Model Context Protocol servers | Memory, Context7, Playwright |
| **API** | REST API endpoints | GitHub API, OpenAI API |
| **Local** | Yerel dosya/klasor | Proje dosyalari, lokal DB |

Sources ayarlari `data/sources.json` dosyasinda saklanir ve Settings sayfasindan yonetilebilir.

### Otonom Calisma

```
Proje Analizi â†’ Roadmap â†’ Faz Execution â†’ Test â†’ Self-Healing â†’ Complete
      â”‚            â”‚            â”‚           â”‚          â”‚
      â–¼            â–¼            â–¼           â–¼          â–¼
 Tech stack    Fazlar      Claude CLI   Playwright  Max 3 retry
  tespit       gorevler    subprocess    + API      otomatik fix
```

| Asama | Detay |
|-------|-------|
| Proje Analizi | Tech stack, yapiyi otomatik tespit |
| Roadmap Olusturma | Fazlar, gorevler, bagimliliklar, milestones |
| Faz Execution | Sirayla veya paralel calisma (bagimsiz gorevler) |
| Otomatik Test | Her faz sonunda Playwright E2E + API testleri |
| Self-Healing | Test basarisizsa otomatik duzeltme (max 3 deneme) |

#### Orchestrator Mimarisi

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ORCHESTRATOR                                 â”‚
â”‚                    (claude-opus-4-5-20251101)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. Task Queue'dan gorev al                                         â”‚
â”‚  2. Uygun agent'i sec (Planner, Implementer, Tester, vs.)          â”‚
â”‚  3. Agent'i spawn et (subprocess)                                   â”‚
â”‚  4. Sonucu degerlendir                                              â”‚
â”‚  5. Basarisizsa: retry veya fallback                                â”‚
â”‚  6. Basariliysa: sonraki goreve gec                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                    â”‚                    â”‚
         â–¼                    â–¼                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   PLANNER   â”‚      â”‚ IMPLEMENTER â”‚      â”‚   TESTER    â”‚
â”‚   (claude)  â”‚      â”‚    (glm)    â”‚      â”‚    (glm)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Task Queue ve Priority

```typescript
interface TaskQueueItem {
  id: string;
  type: 'plan' | 'implement' | 'test' | 'review' | 'fix';
  priority: 'critical' | 'high' | 'normal' | 'low';
  dependencies: string[];    // Beklemesi gereken task id'leri
  status: 'pending' | 'running' | 'completed' | 'failed';
  retries: number;
  maxRetries: number;
  assignedAgent?: string;
}

// Priority sirasi
const PRIORITY_ORDER = ['critical', 'high', 'normal', 'low'];

// Dependency graph ile siralama
function getNextTask(queue: TaskQueueItem[]): TaskQueueItem | null {
  return queue
    .filter(t => t.status === 'pending')
    .filter(t => t.dependencies.every(depId =>
      queue.find(q => q.id === depId)?.status === 'completed'
    ))
    .sort((a, b) =>
      PRIORITY_ORDER.indexOf(a.priority) - PRIORITY_ORDER.indexOf(b.priority)
    )[0] || null;
}
```

#### Paralel Agent Execution

```typescript
// Bagimsiz gorevler paralel calisir
async function executeParallel(tasks: TaskQueueItem[]): Promise<void> {
  // Ayni dependency'si olmayan gorevleri grupla
  const independentTasks = groupIndependentTasks(tasks);

  // Her grup paralel calisir
  for (const group of independentTasks) {
    await Promise.all(
      group.map(task => executeTask(task))
    );
  }
}

// Max 3 paralel agent (kaynak siniri)
const MAX_PARALLEL_AGENTS = 3;

const semaphore = new Semaphore(MAX_PARALLEL_AGENTS);

async function executeTask(task: TaskQueueItem): Promise<void> {
  await semaphore.acquire();
  try {
    const agent = selectAgent(task.type);
    await runAgent(agent, task);
  } finally {
    semaphore.release();
  }
}
```

#### CEO Fallback Pattern

> **Ilham:** auto.filewas'tan alinmistir.
> Bir agent 2 kez basarisiz olursa, Orchestrator (CEO) gorevi devralir.

```typescript
async function executeWithFallback(
  task: TaskQueueItem,
  agent: Agent
): Promise<TaskResult> {
  let retries = 0;

  while (retries < task.maxRetries) {
    try {
      const result = await runAgent(agent, task);

      if (result.success) {
        return result;
      }

      retries++;
    } catch (error) {
      retries++;
    }
  }

  // Max retry asildi â†’ CEO devralir
  console.log(`Agent ${agent.name} failed ${retries} times. CEO taking over.`);

  return await runAgent(
    getAgent('orchestrator'),  // CEO = Orchestrator
    task,
    { context: `Previous agent failed. Fix this issue: ${task.lastError}` }
  );
}
```

#### Self-Healing Detay

```
Test Fail â†’ Analyze Error â†’ Generate Fix â†’ Apply Fix â†’ Re-test
    â”‚            â”‚              â”‚             â”‚           â”‚
    â–¼            â–¼              â–¼             â–¼           â–¼
Playwright   Claude'a     Kod degisikligi   Edit      Playwright
  output     hata analizi    onerisi       tool       tekrar calis
              yaptir
```

```typescript
interface SelfHealingConfig {
  maxAttempts: number;          // Default: 3
  analyzeWithModel: string;     // Default: 'claude' (daha iyi analiz)
  fixWithModel: string;         // Default: 'glm' (hizli fix)
  escalateAfter: number;        // Default: 2 (2 fail â†’ CEO)
}

async function selfHeal(
  testResult: TestResult,
  config: SelfHealingConfig
): Promise<boolean> {
  let attempts = 0;

  while (attempts < config.maxAttempts) {
    // 1. Hatayi analiz et (Claude ile)
    const analysis = await analyzeError(testResult, config.analyzeWithModel);

    // 2. Fix onerisi al
    const fix = await generateFix(analysis, config.fixWithModel);

    // 3. Fix'i uygula
    await applyFix(fix);

    // 4. Testi tekrar calistir
    const retest = await runTests();

    if (retest.passed) {
      return true;  // Basarili!
    }

    attempts++;
    testResult = retest;

    // Escalate to CEO?
    if (attempts >= config.escalateAfter) {
      return await escalateToCEO(testResult, analysis);
    }
  }

  return false;  // Self-healing basarisiz
}
```

#### Otonom Mod Aktivasyonu

```typescript
// Session baslatirken
const session = await createSession({
  projectId,
  mode: 'autonomous',  // 'chat' | 'autonomous'
  permissionMode: 'auto',  // 'safe' | 'ask' | 'auto'
  config: {
    parallelAgents: 3,
    selfHealing: true,
    maxSelfHealAttempts: 3,
    ceoFallback: true,
    autoCommit: true,  // Her faz sonunda commit
    autoPush: false,   // Manuel push (guvenlik)
  }
});

// CLI'a gecirilen flaglar
const cliArgs = session.permissionMode === 'auto'
  ? ['--dangerously-skip-permissions']
  : [];
```

### WebSocket Events (Realtime)

| Event | Direction | Payload | Aciklama |
|-------|-----------|---------|----------|
| `session:created` | Server â†’ Client | `{ sessionId, projectId }` | Yeni session olusturuldu |
| `session:updated` | Server â†’ Client | `{ sessionId, status, ... }` | Session durumu degisti |
| `session:deleted` | Server â†’ Client | `{ sessionId }` | Session silindi |
| `message:new` | Server â†’ Client | `{ messageId, content, role }` | Yeni mesaj eklendi |
| `message:chunk` | Server â†’ Client | `{ messageId, chunk }` | Streaming mesaj parcasi |
| `message:complete` | Server â†’ Client | `{ messageId }` | Mesaj tamamlandi |
| `agent:started` | Server â†’ Client | `{ agentId, type, model }` | Agent calismaya basladi |
| `agent:progress` | Server â†’ Client | `{ agentId, progress, status }` | Agent ilerleme durumu |
| `agent:completed` | Server â†’ Client | `{ agentId, result }` | Agent tamamlandi |
| `agent:error` | Server â†’ Client | `{ agentId, error }` | Agent hata verdi |
| `tool:called` | Server â†’ Client | `{ toolName, params }` | Tool cagrildi |
| `tool:result` | Server â†’ Client | `{ toolName, result }` | Tool sonucu |
| `diff:update` | Server â†’ Client | `{ files, changes }` | Dosya degisiklikleri |
| `test:started` | Server â†’ Client | `{ testId, type }` | Test basladi |
| `test:result` | Server â†’ Client | `{ testId, passed, output }` | Test sonucu |
| `phase:started` | Server â†’ Client | `{ phaseId, name }` | Faz basladi |
| `phase:completed` | Server â†’ Client | `{ phaseId, result }` | Faz tamamlandi |
| `client:typing` | Client â†’ Server | `{ sessionId }` | Kullanici yaziyor |
| `client:stop` | Client â†’ Server | `{ sessionId }` | OluÅŸumu durdur |

### Session Ayarlari

| Ayar | Deger | Aciklama |
|------|-------|----------|
| Auto-save | Her mesajda | Her mesaj aninda JSONL'e yazilir |
| Session timeout | Yok | Session hic expire olmaz |
| Context management | Summarization | Asagida detayli |

### Context Management (Ozetleme)

**Sorun:** Claude'un context window'u sinirli. Uzun sohbetlerde veya cok fazli roadmap'lerde eski mesajlar context'e sigmaz.

**Cozum:** Context %80'e ulastiginda (auto compact'a girmeden once) otomatik ozetleme yapilir.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CONTEXT MANAGEMENT                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  Context %80'e ulasti                                                    â”‚
â”‚        â”‚                                                                 â”‚
â”‚        â–¼                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚  â”‚ GLM'e ozet yaptir (maliyet tasarrufu)   â”‚                            â”‚
â”‚  â”‚ "Su ana kadar ne yapildi, hangi         â”‚                            â”‚
â”‚  â”‚  kararlar alindi, onemli notlar"        â”‚                            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â”‚        â”‚                                                                 â”‚
â”‚        â–¼                                                                 â”‚
â”‚  Yeni context = [Ozet] + [Son N mesaj]                                  â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

| Parametre | Deger | Aciklama |
|-----------|-------|----------|
| Tetikleme | %80 context | Auto compact'a girmeden once |
| Ozet modeli | GLM | Maliyet tasarrufu (Claude degil) |
| Sliding window | Son 30-50 mesaj | Tam olarak korunur |
| Ozet icerigi | Kararlar, yapilan isler, onemli notlar | Faz bilgileri, tech stack kararlari |
| Ozet saklama | Session JSONL | `{"type":"summary", "content":"..."}` |

**Ornek ozet:**
```
## Session Ozeti (Faz 1-15)

**Alinan Kararlar:**
- PostgreSQL veritabani kullanilacak
- JWT authentication tercih edildi
- Stripe odeme entegrasyonu

**Tamamlanan Isler:**
- Faz 1-15 tamamlandi
- User, Product, Order tablolari olusturuldu
- Auth API implement edildi

**Onemli Notlar:**
- Rate limit icin Redis gerekebilir
- Mobile app icin API versiyonlama dusunulmeli
```

### Agent Ayarlari

| Ayar | Deger | Aciklama |
|------|-------|----------|
| Agent timeout | Limitsiz | Bitene kadar bekle |
| Error retry | 3 deneme | Exponential backoff (1s, 2s, 4s) |
| Fallback | Enabled | Claude fail â†’ GLM'e gec (ayarlanabilir) |

### Agent Context Injection (Agent Ne Yapacagini Nasil Biliyor?)

Agent spawn edildiginde, CLI'a su bilgiler gonderilir:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     AGENT'A GONDERILEN CONTEXT                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  1. SYSTEM PROMPT (Agent Tanimi)                                        â”‚
â”‚     â””â”€â”€ agents/planner.md iceriginden                                   â”‚
â”‚         - name, description, tools, model                               â”‚
â”‚         - Agent'in rolu ve kurallari                                    â”‚
â”‚                                                                          â”‚
â”‚  2. CLAUDE.md (Proje Kurallari)                                         â”‚
â”‚     â””â”€â”€ projects/proje-adi/CLAUDE.md                                    â”‚
â”‚         - Proje hakkinda bilgi                                          â”‚
â”‚         - Dosya yapisi                                                  â”‚
â”‚         - Kurallar (ne yapma, ne yap)                                   â”‚
â”‚         - Faz tamamlama protokolu                                       â”‚
â”‚                                                                          â”‚
â”‚  3. INJECT EDILEN DOKUMANLAR                                            â”‚
â”‚     â”œâ”€â”€ overview.md     â†’ Proje amaci, tech stack                       â”‚
â”‚     â””â”€â”€ roadmap.jsonl   â†’ Mevcut faz, gorevler                          â”‚
â”‚                                                                          â”‚
â”‚  4. MEMORY (MCP ile)                                                    â”‚
â”‚     â””â”€â”€ Memory MCP tool'lari ile sorgulaniyor (memory.json YOK)         â”‚
â”‚         - mcp__memory__search_nodes("proje kararlari")                  â”‚
â”‚         - Proje-spesifik bilgiler entity olarak sakli                   â”‚
â”‚                                                                          â”‚
â”‚  4. HANDOFF (Onceki Agent'in Ciktisi)                                   â”‚
â”‚     â””â”€â”€ Eger zincirde onceki agent varsa                                â”‚
â”‚         - Ne yapildi                                                    â”‚
â”‚         - Hangi dosyalar degisti                                        â”‚
â”‚         - Acik sorular                                                  â”‚
â”‚         - Oneriler                                                      â”‚
â”‚                                                                          â”‚
â”‚  5. GOREV PROMPT'U                                                      â”‚
â”‚     â””â”€â”€ Kullanicinin istegi veya faz gorevi                             â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Prompt Olusturma Ornegi:**

```typescript
// backend/src/orchestrator/prompt-builder.ts

interface PromptContext {
  agent: AgentConfig;
  project: Project;
  phase?: Phase;
  handoff?: Handoff;
  userPrompt: string;
}

function buildAgentPrompt(ctx: PromptContext): string {
  const sections: string[] = [];

  // 1. Agent tanimi (system prompt olarak)
  // Bu --system-prompt flag'i ile gonderilir

  // 2. CLAUDE.md
  const claudeMd = readFileSync(
    `${ctx.project.path}/CLAUDE.md`,
    'utf-8'
  );
  sections.push(`<project-rules>\n${claudeMd}\n</project-rules>`);

  // 3. Inject edilen dokumanlar
  const docs = loadProjectDocs(ctx.project, ctx.phase?.version);
  sections.push(`<overview>\n${docs.overview}\n</overview>`);
  sections.push(`<roadmap>\n${docs.roadmap}\n</roadmap>`);  // JSONL icerigi

  // NOT: Memory inject edilmiyor - Agent gerektiginde Memory MCP kullanir
  // mcp__memory__search_nodes("proje kararlari") ile sorgular

  // 4. Mevcut faz bilgisi
  if (ctx.phase) {
    sections.push(`<current-phase>
Faz: ${ctx.phase.id} - ${ctx.phase.name}
Gorevler:
${ctx.phase.tasks.map(t => `- [ ] ${t.title}`).join('\n')}
</current-phase>`);
  }

  // 5. Onceki agent'in handoff'u
  if (ctx.handoff) {
    sections.push(`<handoff from="${ctx.handoff.agent}">
## Yapilan Isler
${ctx.handoff.summary}

## Degisen Dosyalar
${ctx.handoff.files.join('\n')}

## Acik Sorular
${ctx.handoff.questions.join('\n')}

## Oneriler
${ctx.handoff.recommendations.join('\n')}
</handoff>`);
  }

  // 6. Asil gorev
  sections.push(`<task>\n${ctx.userPrompt}\n</task>`);

  return sections.join('\n\n');
}
```

**CLI'a Gonderim:**

```typescript
// Agent spawn
const systemPrompt = agent.content;  // agents/planner.md icerigi
const userPrompt = buildAgentPrompt(ctx);

const proc = spawn(command, [
  '-p',
  '--system-prompt', systemPrompt,  // Agent tanimi
  '--output-format', 'stream-json'
], { cwd: project.path });

// User prompt stdin'den gonderilir
proc.stdin.write(userPrompt);
proc.stdin.end();
```

**Ozet: Agent su bilgilerle baslar:**

| Bilgi | Kaynak | Amac |
|-------|--------|------|
| Agent tanimi | `agents/*.md` | Ne tur bir agent oldugunu bilmesi |
| Proje kurallari | `CLAUDE.md` | Global platform kurallari |
| Overview | `docs/vX.Y.Z/overview.md` | Proje ne hakkinda |
| Roadmap | `docs/vX.Y.Z/roadmap.jsonl` | Hangi fazda, hangi gorevler |
| Memory | Memory MCP (tool ile sorgu) | Onemli kararlar, dersler |
| Handoff | Onceki agent | Zincirde siradaki ne bilmeli |
| Gorev | Kullanici/Orchestrator | Ne yapmasi gerekiyor |

### Agent Status UI (Kullanici Agent Calisirken Ne Goruyor?)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CHAT AREA                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ‘¤ User                                                           â”‚  â”‚
â”‚  â”‚ "Authentication sistemi ekle"                                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ¤– Assistant                     Phase 1/5 Â· Planner Â· claude     â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚ ğŸ”„ AGENT CALISIYOR: Planner                                 â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ Model: claude-opus-4-5-20251101                             â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ Durum: Proje yapisini analiz ediyor...                      â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 45%              â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚ ğŸ“ TOOL: Glob                                               â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ Pattern: "**/*.ts"                                          â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ Sonuc: 23 dosya bulundu                                     â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚ ğŸ“– TOOL: Read                                               â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ Dosya: src/index.ts                                         â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ Sonuc: 145 satir okundu                                     â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚  Agent ciktisi burada streaming olarak gorunur...              â”‚  â”‚  â”‚
â”‚  â”‚  "Proje yapisini inceledim. Tech stack:                        â”‚  â”‚  â”‚
â”‚  â”‚   - Backend: Express + TypeScript                              â”‚  â”‚  â”‚
â”‚  â”‚   - Frontend: React + Vite                                     â”‚  â”‚  â”‚
â”‚  â”‚   - Storage: File-based (JSONL)                                â”‚  â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   Authentication icin su plani oneriyorum:                     â”‚  â”‚  â”‚
â”‚  â”‚   1. JWT token sistemi                                         â”‚  â”‚  â”‚
â”‚  â”‚   2. Login/Register API endpoints                              â”‚  â”‚  â”‚
â”‚  â”‚   3. Auth middleware                                           â”‚  â”‚  â”‚
â”‚  â”‚   ..."                                                         â”‚  â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Agent Status Card BileÅŸenleri:**

```typescript
// frontend/src/components/chat/AgentStatusCard.tsx

interface AgentStatusCardProps {
  agent: {
    id: string;
    name: string;           // "Planner"
    model: string;          // "claude-opus-4-5-20251101"
    status: AgentStatus;    // 'running' | 'completed' | 'error'
    progress?: number;      // 0-100
    currentAction?: string; // "Proje yapisini analiz ediyor..."
  };
  phase?: {
    current: number;
    total: number;
  };
}

type AgentStatus = 'pending' | 'running' | 'completed' | 'error';

// Status renkleri
const STATUS_COLORS = {
  pending: 'text-muted',
  running: 'text-blue-500',
  completed: 'text-green-500',
  error: 'text-red-500'
};

// Status ikonlari
const STATUS_ICONS = {
  pending: 'â³',
  running: 'ğŸ”„',  // Animated spinner
  completed: 'âœ…',
  error: 'âŒ'
};
```

**Tool Call Visualization:**

```typescript
// frontend/src/components/chat/ToolCallCard.tsx

interface ToolCallCardProps {
  tool: {
    name: string;       // "Glob", "Read", "Edit", "Bash"
    params: object;     // Tool parametreleri
    result?: string;    // Tool sonucu
    status: 'running' | 'completed' | 'error';
    duration?: number;  // ms
  };
}

// Tool ikonlari
const TOOL_ICONS = {
  Glob: 'ğŸ“',
  Read: 'ğŸ“–',
  Edit: 'âœï¸',
  Write: 'ğŸ“',
  Bash: 'ğŸ’»',
  Grep: 'ğŸ”',
  WebFetch: 'ğŸŒ',
  Task: 'ğŸ¤–'  // Subagent
};
```

**WebSocket Event â†’ UI Guncellemesi:**

```typescript
// frontend/src/hooks/useAgentStatus.ts

function useAgentStatus(sessionId: string) {
  const [agents, setAgents] = useState<AgentState[]>([]);
  const [tools, setTools] = useState<ToolCall[]>([]);

  useEffect(() => {
    const socket = getSocket();

    // Agent basladi
    socket.on('agent:started', (data) => {
      setAgents(prev => [...prev, {
        id: data.agentId,
        name: data.type,
        model: data.model,
        status: 'running',
        progress: 0,
        startedAt: Date.now()
      }]);
    });

    // Agent ilerleme
    socket.on('agent:progress', (data) => {
      setAgents(prev => prev.map(a =>
        a.id === data.agentId
          ? { ...a, progress: data.progress, currentAction: data.status }
          : a
      ));
    });

    // Agent tamamlandi
    socket.on('agent:completed', (data) => {
      setAgents(prev => prev.map(a =>
        a.id === data.agentId
          ? { ...a, status: 'completed', progress: 100 }
          : a
      ));
    });

    // Tool cagrildi
    socket.on('tool:called', (data) => {
      setTools(prev => [...prev, {
        id: data.toolId,
        name: data.toolName,
        params: data.params,
        status: 'running',
        startedAt: Date.now()
      }]);
    });

    // Tool sonucu
    socket.on('tool:result', (data) => {
      setTools(prev => prev.map(t =>
        t.id === data.toolId
          ? { ...t, status: 'completed', result: data.result, duration: Date.now() - t.startedAt }
          : t
      ));
    });

    return () => {
      socket.off('agent:started');
      socket.off('agent:progress');
      socket.off('agent:completed');
      socket.off('tool:called');
      socket.off('tool:result');
    };
  }, [sessionId]);

  return { agents, tools };
}
```

**Multi-Agent Workflow Gorseli:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ WORKFLOW: feature                                                        â”‚
â”‚ Task: "Authentication sistemi ekle"                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ Planner  â”‚ â†’ â”‚ TDD Guideâ”‚ â†’ â”‚ Reviewer â”‚ â†’ â”‚ Security â”‚          â”‚
â”‚  â”‚    âœ…    â”‚    â”‚    ğŸ”„    â”‚    â”‚    â³    â”‚    â”‚    â³    â”‚          â”‚
â”‚  â”‚ 2m 34s   â”‚    â”‚ running  â”‚    â”‚ pending  â”‚    â”‚ pending  â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                          â”‚
â”‚  Progress: â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 35%        â”‚
â”‚  Agent 2/4 Â· TDD Guide Â· glm Â· Test yaziyor...                          â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Ozet: Kullanici Sunlari Goruyor:**

| UI Elementi | Gosterilen Bilgi | Kaynak Event |
|-------------|------------------|--------------|
| Agent Status Card | Hangi agent, hangi model, ne yapiyor | `agent:started`, `agent:progress` |
| Progress Bar | Ilerleme yuzdesi | `agent:progress` |
| Tool Call Cards | Hangi tool, parametreler, sonuc | `tool:called`, `tool:result` |
| Streaming Output | Agent'in text ciktisi | `message:chunk` |
| Workflow Diagram | Tum agent zinciri, hangisi aktif | `agent:*` events |
| Phase Indicator | Kacinci faz, toplam faz | `phase:started` |
| Error Alert | Hata durumu, retry bilgisi | `agent:error` |

### Logging

| Log Tipi | Hedef | Aciklama |
|----------|-------|----------|
| API logs | JSONL | Request/response loglanir (`data/logs/api.jsonl`) |
| Agent logs | JSONL | Agent execution loglanir (`data/logs/agents.jsonl`) |
| Error logs | JSONL | Tum hatalar loglanir (`data/logs/errors.jsonl`) |
| Audit logs | JSONL | Kritik islemler loglanir (`data/logs/audit.jsonl`) |

### Backup

| Strateji | Zamanlama | Aciklama |
|----------|-----------|----------|
| Git commit | Her commit | JSONL dosyalari GitHub'a push |
| Auto-push | Faz tamamlandiginda | Otomatik commit + push |

### Git Branch Stratejisi

**Iki farkli calisma modu, iki farkli branch stratejisi:**

#### 1. Manuel Session (Tek tek gorev verme)

```
main
 â”‚
 â”œâ”€â”€ session/abc123 â”€â”€â”€â”€ commit â”€â”€â”€â”€ commit â”€â”€â”€â”€ merge â†’ main
 â”‚
 â”œâ”€â”€ session/def456 â”€â”€â”€â”€ commit â”€â”€â”€â”€ commit â”€â”€â”€â”€ merge â†’ main
 â”‚
 â””â”€â”€ session/ghi789 â”€â”€â”€â”€ commit â”€â”€â”€â”€ ...
```

| Durum | Davranis |
|-------|----------|
| Yeni session | `session/{session-id}` branch olusturulur |
| Gorev tamamlaninca | Ayni branch'e commit |
| Session kapaninca | main'e merge (veya kullanici karari) |

#### 2. Otonom Roadmap (Faz faz otomatik calisma)

```
main
 â”‚
 â””â”€â”€ v0.1.0 â”€â”€â”€â”€ faz1 â”€â”€â”€â”€ faz2 â”€â”€â”€â”€ faz3 â”€â”€â”€â”€ ... â”€â”€â”€â”€ fazN â”€â”€â”€â”€ merge â†’ main
         â”‚
         â””â”€â”€ Tum fazlar ayni branch'te, versiyon numarasiyla
```

| Durum | Davranis |
|-------|----------|
| Roadmap onaylaninca | `v{major}.{minor}.{patch}` branch olusturulur (ornek: `v0.1.0`) |
| Her faz tamamlaninca | Ayni branch'e commit |
| Tum fazlar bitince | main'e merge (veya kullanici karari) |

**Commit mesaj formati:**
```
[Faz N] Faz basligi

- Degisiklik 1
- Degisiklik 2

Co-Authored-By: Task.filewas <noreply@task.filewas.com>
```

---

## Dual Model Sistemi

Task.filewas iki farkli Claude backend'i kullanir:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        DUAL MODEL ARCHITECTURE                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         CLAUDE (Opus 4.5)       â”‚           GLM (4.7)               â”‚
â”‚         Anthropic Max Plan      â”‚         Z.AI Coding Plan          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Komut: `claude`                 â”‚ Komut: `glm`                      â”‚
â”‚ Config: ~/.claude/              â”‚ Config: ~/.claude-glm/            â”‚
â”‚ Backend: Anthropic API          â”‚ Backend: api.z.ai/api/anthropic   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ KULLANIM ALANI:                 â”‚ KULLANIM ALANI:                   â”‚
â”‚ â€¢ Complex reasoning             â”‚ â€¢ Kod yazma (rutin)               â”‚
â”‚ â€¢ Mimari kararlar               â”‚ â€¢ Code review                     â”‚
â”‚ â€¢ Ultrathink (max)              â”‚ â€¢ Test yazma                      â”‚
â”‚ â€¢ Guvenlik analizi              â”‚ â€¢ Debugging (basit)               â”‚
â”‚ â€¢ Orchestration                 â”‚ â€¢ Quick tasks                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Model Providers

| Provider | Komut | Config | Backend | Kullanim |
|----------|-------|--------|---------|----------|
| **Claude** | `claude` | `~/.claude/` | Anthropic API | Kritik gorevler, ultrathink |
| **GLM** | `glm` | `~/.claude-glm/` | Z.AI API | Rutin gorevler, kod yazma |

### Agent â†’ Model Mapping (Varsayilan)

| Agent | Default Model | Override | Neden |
|-------|---------------|----------|-------|
| Orchestrator | `claude` | âœ… | Kritik koordinasyon, complex reasoning |
| Planner | `claude` | âœ… | Faz planlama |
| Architect | `claude` | âœ… | Mimari kararlar, sistem tasarimi |
| Security | `claude` | âœ… | Guvenlik analizi kritik |
| Implementer | `glm` | âœ… | Rutin kod yazma |
| Reviewer | `glm` | âœ… | Kod inceleme, pattern matching |
| Tester | `glm` | âœ… | Test yazma |
| Debugger | `glm` | âœ… | Basit hata ayiklama |

### Thinking Level â†’ Model Mapping

| Thinking Level | Model | Zorunlu | Aciklama |
|----------------|-------|---------|----------|
| `max` (ultrathink) | `claude` | âœ… Evet | Maksimum reasoning sadece Opus |
| `think` | `claude` | âŒ Tercih | Extended thinking, fallback GLM |
| `off` | `glm` | âŒ Varsayilan | Hizli yanit yeterli |

### Hybrid Mode

Ayni session icerisinde farkli agent'lar farkli model kullanabilir:

```
Session #42: "E-commerce checkout flow"
â”œâ”€â”€ [claude] Planner â†’ Faz plani olusturdu
â”œâ”€â”€ [glm] Implementer â†’ PaymentForm.tsx yazdi
â”œâ”€â”€ [glm] Implementer â†’ usePayment.ts yazdi
â”œâ”€â”€ [glm] Tester â†’ payment.spec.ts yazdi
â”œâ”€â”€ [claude] Security â†’ Guvenlik analizi yapti (XSS, CSRF)
â””â”€â”€ [glm] Reviewer â†’ Code review tamamladi
```

### Fallback Chain

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     Rate Limit/Error     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   CLAUDE    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶   â”‚     GLM     â”‚
â”‚   (Opus)    â”‚                          â”‚   (4.7)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                                        â”‚
       â”‚  â—„â”€â”€â”€â”€â”€ Fallback Enabled â”€â”€â”€â”€â”€â–º       â”‚
       â”‚        (Ayarlardan kapatilabilir)      â”‚
```

| Fallback Durumu | Davranis |
|-----------------|----------|
| **Enabled (Varsayilan)** | Claude fail â†’ GLM'e otomatik gec |
| **Disabled** | Claude fail â†’ Hata goster, kullanici karar versin |

**Ayarlar:**
```json
{
  "models": {
    "fallbackEnabled": true,
    "fallbackOrder": ["claude", "glm"]
  }
}
```

### User Override (Session Bazli)

Kullanici UI'dan session icin model secebilir:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Yeni Session                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Model:  â—‹ Auto (agent'a gore)                   â”‚
â”‚         â— Claude (Opus 4.5)                     â”‚
â”‚         â—‹ GLM (4.7)                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [x] Bu session icin tum agent'lar secili modeli â”‚
â”‚     kullansin                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

| Override Modu | Davranis |
|---------------|----------|
| **Auto** | Her agent kendi default modelini kullanir |
| **Force Claude** | Tum agent'lar Claude kullanir |
| **Force GLM** | Tum agent'lar GLM kullanir |

### Config Yapisi

```typescript
// backend/src/config/models.ts
export const modelConfig = {
  providers: {
    claude: {
      command: 'claude',
      configDir: '~/.claude/',
      capabilities: ['ultrathink', 'extended-thinking', 'complex-reasoning'],
      priority: 1
    },
    glm: {
      command: 'glm',
      configDir: '~/.claude-glm/',
      capabilities: ['code-generation', 'review', 'testing'],
      priority: 2
    }
  },

  agentDefaults: {
    orchestrator: 'claude',
    planner: 'claude',
    architect: 'claude',
    security: 'claude',
    implementer: 'glm',
    reviewer: 'glm',
    tester: 'glm',
    debugger: 'glm'
  },

  thinkingLevelMapping: {
    max: { model: 'claude', required: true },
    think: { model: 'claude', required: false },
    off: { model: 'glm', required: false }
  },

  fallback: {
    enabled: true,  // Ayarlardan degistirilebilir
    chain: ['claude', 'glm']
  }
}
```

### Agent MD Format (Model Alani)

```markdown
---
name: implementer
description: Kod yazma agent'i
tools: ["Read", "Write", "Edit", "Bash"]
model: glm                    # Varsayilan model (claude | glm)
model_override_allowed: true  # Kullanici degistirebilir mi
thinking_level: off           # Varsayilan thinking (off | think | max)
---

You are a code implementation specialist...
```

---

## Agent Sistemi

```
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚   ORCHESTRATOR  â”‚
                              â”‚   (koordine)    â”‚
                              â”‚  model: claude  â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”´â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚              â”‚               â”‚ â”‚               â”‚              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â–¼â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
â”‚   PLANNER   â”‚ â”‚ ARCHITECT â”‚  â”‚ IMPLEMENTER â”‚  â”‚   TESTER    â”‚ â”‚  SECURITY   â”‚
â”‚  (faz ayir) â”‚ â”‚ (tasarim) â”‚  â”‚  (kod yaz)  â”‚  â”‚ (test yaz)  â”‚ â”‚ (guvenlik)  â”‚
â”‚model: claudeâ”‚ â”‚mod: claudeâ”‚  â”‚ model: glm  â”‚  â”‚ model: glm  â”‚ â”‚model: claudeâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                              â”‚                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
â”‚  REVIEWER   â”‚                â”‚  DEBUGGER   â”‚  â”‚   (diger)   â”‚
â”‚(kod incele) â”‚                â”‚ (hata bul)  â”‚  â”‚             â”‚
â”‚ model: glm  â”‚                â”‚ model: glm  â”‚  â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

| Agent | Gorev | Model | Override | Tools |
|-------|-------|-------|----------|-------|
| Orchestrator | Diger agent'lari koordine eder | `claude` | âœ… | Task, Read, Glob |
| Planner | Projeyi fazlara ayirir | `claude` | âœ… | Read, Glob, Grep |
| Architect | Sistem tasarimi, mimari kararlar | `claude` | âœ… | Read, Glob, Grep |
| Implementer | Kod yazar | `glm` | âœ… | Read, Write, Edit, Bash |
| Reviewer | Code review yapar | `glm` | âœ… | Read, Glob, Grep |
| Tester | Test yazar ve calistirir | `glm` | âœ… | Read, Write, Bash |
| Security | Guvenlik analizi | `claude` | âœ… | Read, Grep, Bash |
| Debugger | Hata ayiklama | `glm` | âœ… | Read, Bash, Grep |

**Paralel Calisma:** Bagimsiz gorevlerde eszamanli agent calistirma destegi.
**Hybrid Mode:** Ayni session'da farkli agent'lar farkli model kullanabilir.

### CLI Kullanimi

> **Karar:** SDK yerine CLI subprocess kullaniyoruz.
> - SDK (claude-agent-sdk) sadece Anthropic API'ye baglanir
> - CLI subprocess ile hem `claude` hem `glm` kullanabiliyoruz
> - Mevcut hooks, settings, plugins calisir
> - Farkli backend'ler desteklenir (Anthropic, Z.AI)

#### Temel Spawn

**Claude (Opus - Max Plan):**
```typescript
const proc = spawn('claude', [
  '-p',                              // Print mode (non-interactive)
  '--output-format', 'stream-json',  // NDJSON streaming
  '--verbose',                       // Detayli log
  '--model', 'claude-opus-4-5-20251101'
], {
  cwd: projectDir,
  shell: true,
  env: { ...process.env }
});

// Prompt stdin'den gonderilir
proc.stdin.write(prompt);
proc.stdin.end();
```

**GLM (Coding Plan - Z.AI):**
```typescript
const proc = spawn('glm', [
  '-p',
  '--output-format', 'stream-json',
  '--verbose'
], {
  cwd: projectDir,
  shell: true
});
```

#### Session Devami (Resume)

```typescript
// Onceki session'a devam etmek icin -r flag
const proc = spawn('claude', [
  '-r', sessionId,                   // Resume session
  '-p',
  '--output-format', 'stream-json'
], { cwd: projectDir });
```

#### Permission Modes

```typescript
// Safe Mode (varsayilan) - Her islemde onay ister
const proc = spawn('claude', ['-p', prompt]);

// Otonom Mode - Tam yetki, onay istemez
const proc = spawn('claude', [
  '--dangerously-skip-permissions',  // TAM OTONOM
  '-p',
  '--output-format', 'stream-json'
], { cwd: projectDir });
```

| Mode | Flag | Kullanim |
|------|------|----------|
| Safe | (varsayilan) | Kullanici onaylÄ± islemler |
| Ask | `--permission-mode ask` | Her tool icin onay |
| Auto | `--dangerously-skip-permissions` | Tam otonom, onay yok |

#### NDJSON Streaming Parse

```typescript
import { createInterface } from 'readline';

const rl = createInterface({ input: proc.stdout });

rl.on('line', (line) => {
  try {
    const event = JSON.parse(line);

    switch (event.type) {
      case 'assistant':
        // Claude'un text cevabi
        handleAssistantMessage(event.message);
        break;

      case 'tool_use':
        // Tool cagirimi (Read, Edit, Bash, vs.)
        handleToolUse(event.tool, event.input);
        break;

      case 'tool_result':
        // Tool sonucu
        handleToolResult(event.tool, event.output);
        break;

      case 'error':
        // Hata
        handleError(event.error);
        break;

      case 'result':
        // Session tamamlandi
        handleComplete(event.session_id, event.cost);
        break;
    }
  } catch (e) {
    // JSON parse hatasi, plain text olabilir
    handlePlainText(line);
  }
});

proc.on('close', (code) => {
  if (code !== 0) {
    handleProcessError(code);
  }
});
```

#### Error Handling & Timeout

```typescript
interface ClaudeProcessOptions {
  timeout?: number;        // Max execution time (ms)
  maxRetries?: number;     // Retry count on failure
  fallbackModel?: string;  // Fallback to other model
}

async function runClaude(
  prompt: string,
  options: ClaudeProcessOptions = {}
): Promise<ClaudeResult> {
  const { timeout = 300000, maxRetries = 2, fallbackModel = 'glm' } = options;

  let retries = 0;
  let lastError: Error | null = null;

  while (retries <= maxRetries) {
    try {
      const command = retries === maxRetries ? fallbackModel : 'claude';
      const result = await executeWithTimeout(command, prompt, timeout);
      return result;
    } catch (error) {
      lastError = error;
      retries++;

      if (isRateLimitError(error)) {
        // Rate limit â†’ fallback modele gec
        break;
      }

      await delay(1000 * retries); // Exponential backoff
    }
  }

  throw lastError;
}
```

#### Model Secimi (Runtime)

```typescript
interface ModelConfig {
  command: 'claude' | 'glm';
  model?: string;
  thinkingLevel?: 'basic' | 'extended' | 'ultrathink';
}

const MODEL_MAP: Record<string, ModelConfig> = {
  // Opus - karmasik gorevler (mimari, guvenlik, orchestration)
  orchestrator: { command: 'claude', model: 'claude-opus-4-5-20251101' },
  planner: { command: 'claude', model: 'claude-opus-4-5-20251101' },
  architect: { command: 'claude', model: 'claude-opus-4-5-20251101' },
  security: { command: 'claude', model: 'claude-opus-4-5-20251101' },

  // GLM - rutin gorevler, kod yazma, test, review
  implementer: { command: 'glm' },
  reviewer: { command: 'glm' },
  debugger: { command: 'glm' },
  tester: { command: 'glm' },
};

function getModelCommand(agentName: string, override?: string): ModelConfig {
  if (override) {
    return override === 'glm'
      ? { command: 'glm' }
      : { command: 'claude', model: override };
  }
  return MODEL_MAP[agentName] || { command: 'claude' };
}

// Kullanim
const config = getModelCommand(agent.name, session.modelOverride);
const proc = spawn(config.command, [
  '-p',
  ...(config.model ? ['--model', config.model] : []),
  '--output-format', 'stream-json'
], { cwd: projectDir });
```

#### CLI Wrapper Service

```typescript
// backend/src/claude/cli-service.ts

export class ClaudeCliService {
  private activeProcesses: Map<string, ChildProcess> = new Map();

  async execute(request: ClaudeRequest): Promise<ClaudeResponse> {
    const {
      prompt,
      sessionId,
      model = 'claude',
      autonomous = false,
      cwd
    } = request;

    const args = this.buildArgs({ sessionId, autonomous });
    const proc = spawn(model, args, { cwd, shell: true });

    this.activeProcesses.set(sessionId, proc);

    proc.stdin.write(prompt);
    proc.stdin.end();

    return this.collectResponse(proc, sessionId);
  }

  private buildArgs(options: ClaudeOptions): string[] {
    const args = ['-p', '--output-format', 'stream-json', '--verbose'];

    if (options.sessionId) {
      args.push('-r', options.sessionId);
    }

    if (options.autonomous) {
      args.push('--dangerously-skip-permissions');
    }

    return args;
  }

  async abort(sessionId: string): Promise<void> {
    const proc = this.activeProcesses.get(sessionId);
    if (proc) {
      proc.kill('SIGTERM');
      this.activeProcesses.delete(sessionId);
    }
  }
}
```

---

## Tech Stack

### Proje Yapisi

| Kategori | Teknoloji | Aciklama |
|----------|-----------|----------|
| Monorepo | pnpm workspaces | Tek `pnpm install` ile tum bagimliliklar |
| Package Manager | pnpm | Hizli, disk tasarrufu |
| Linting | ESLint | Code quality |
| Formatting | Prettier | Code style |
| Unit Test | Vitest | Vite-native, hizli |
| E2E Test | Playwright | Browser testleri |

### Backend

| Kategori | Teknoloji | Versiyon | Aciklama |
|----------|-----------|----------|----------|
| Runtime | Node.js | 22+ | LTS |
| Language | TypeScript | 5.6+ | Strict mode |
| Framework | Express | 4.x | REST API |
| Storage | File-based | JSONL/JSON/MD | Craft Agents gibi |
| WebSocket | Socket.io | 4.x | Realtime |
| Process | Claude Code CLI | - | Subprocess |
| Validation | Zod | 3.x | Schema validation |

### Frontend

| Kategori | Teknoloji | Versiyon | Aciklama |
|----------|-----------|----------|----------|
| Framework | React | 18.x | UI library |
| Build | Vite | 5.x | Build tool |
| Routing | React Router | v6 | Sayfa yonetimi |
| Styling | Tailwind CSS | 3.x | Utility-first CSS |
| UI Components | Radix UI | latest | Headless UI |
| State | Zustand | 4.x | State management |
| Data Fetching | TanStack Query | 5.x | Server state |
| Forms | React Hook Form + Zod | latest | Form validation |
| Animation | Framer Motion | latest | UI animasyonlari |
| Icons | Lucide React | latest | Icon library |
| Code Viewer | Shiki | latest | Syntax highlighting |
| Markdown | Marked | latest | Markdown parser |
| Diff Viewer | react-diff-viewer-continued | latest | Hafif diff gorunumu |

---

## Dosya Yapisi

```
task.filewas/
â”œâ”€â”€ .task/                    # Global ECC dosyalari
â”‚   â”œâ”€â”€ agents/               # Agent tanimlari (*.md)
â”‚   â”‚   â”œâ”€â”€ orchestrator.md
â”‚   â”‚   â”œâ”€â”€ planner.md
â”‚   â”‚   â”œâ”€â”€ architect.md
â”‚   â”‚   â”œâ”€â”€ implementer.md
â”‚   â”‚   â”œâ”€â”€ reviewer.md
â”‚   â”‚   â”œâ”€â”€ tester.md
â”‚   â”‚   â”œâ”€â”€ security.md
â”‚   â”‚   â””â”€â”€ debugger.md
â”‚   â”œâ”€â”€ skills/               # Skill tanimlari (**/*.md)
â”‚   â”œâ”€â”€ hooks/                # Hook tanimlari (hooks.json)
â”‚   â””â”€â”€ commands/             # Komut tanimlari (*.md)
â”‚
â”œâ”€â”€ data/                     # PLATFORM VERILERI (Craft Agents tarzi)
â”‚   â”œâ”€â”€ sessions/             # Session JSONL dosyalari
â”‚   â”‚   â”œâ”€â”€ proje-adi--v0.1.0.jsonl
â”‚   â”‚   â”œâ”€â”€ proje-adi--v0.2.0.jsonl
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ sources.json          # MCP, API, Local kaynak tanimlari
â”‚   â”œâ”€â”€ settings.json         # Genel platform ayarlari
â”‚   â””â”€â”€ statuses.json         # Custom status tanimlari
â”‚
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ routes/           # API endpoints
â”‚   â”‚   â”œâ”€â”€ services/         # Business logic
â”‚   â”‚   â”œâ”€â”€ orchestrator/     # Agent koordinasyonu
â”‚   â”‚   â”œâ”€â”€ claude/           # Claude CLI wrapper
â”‚   â”‚   â”œâ”€â”€ storage/          # File-based storage (JSONL/JSON)
â”‚   â”‚   â”œâ”€â”€ sessions/         # Session CRUD
â”‚   â”‚   â”œâ”€â”€ sources/          # Source yonetimi
â”‚   â”‚   â”œâ”€â”€ testing/          # Playwright runner
â”‚   â”‚   â””â”€â”€ utils/
â”‚   â””â”€â”€ dist/
â”‚
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”œâ”€â”€ layout/       # 3 panel layout
â”‚   â”‚   â”‚   â”œâ”€â”€ inbox/        # Session list, filters
â”‚   â”‚   â”‚   â”œâ”€â”€ chat/         # Messages, phases, cards
â”‚   â”‚   â”‚   â”œâ”€â”€ code-viewer/  # Syntax highlighted code
â”‚   â”‚   â”‚   â”œâ”€â”€ markdown/     # Markdown renderer
â”‚   â”‚   â”‚   â”œâ”€â”€ diff/         # Multi-file diff viewer
â”‚   â”‚   â”‚   â”œâ”€â”€ terminal/     # Terminal output
â”‚   â”‚   â”‚   â””â”€â”€ ui/           # Base UI components
â”‚   â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”œâ”€â”€ stores/           # Zustand stores
â”‚   â”‚   â””â”€â”€ hooks/
â”‚   â””â”€â”€ public/
â”‚
â”œâ”€â”€ shared/                   # Shared TypeScript types
â”‚   â”œâ”€â”€ types/                # Ortak tip tanimlari
â”‚   â”œâ”€â”€ sessions/             # Session tipleri ve utils
â”‚   â”œâ”€â”€ sources/              # Source tipleri
â”‚   â”œâ”€â”€ skills/               # Skill tipleri
â”‚   â”œâ”€â”€ statuses/             # Status tipleri
â”‚   â””â”€â”€ utils/                # Ortak yardimci fonksiyonlar
â”‚
â”œâ”€â”€ projects/                 # KULLANICI PROJELERI
â”‚   â””â”€â”€ proje-adi/
â”‚       â”œâ”€â”€ CLAUDE.md         # PROJE-OZEL KURALLAR
â”‚       â”œâ”€â”€ .task/            # Global'den kopyalanan ECC
â”‚       â”œâ”€â”€ docs/             # VERSIYON BAZLI DOKUMANLAR
â”‚       â”‚   â”œâ”€â”€ v0.1.0/
â”‚       â”‚   â”‚   â”œâ”€â”€ overview.md
â”‚       â”‚   â”‚   â”œâ”€â”€ roadmap.jsonl
â”‚       â”‚   â”‚   â””â”€â”€ changelog.jsonl
â”‚       â”‚   â”œâ”€â”€ v0.2.0/
â”‚       â”‚   â”‚   â”œâ”€â”€ overview.md
â”‚       â”‚   â”‚   â”œâ”€â”€ roadmap.jsonl
â”‚       â”‚   â”‚   â””â”€â”€ changelog.jsonl
â”‚       â”‚   â””â”€â”€ ...
â”‚       â”œâ”€â”€ uploads/          # YUKLENEN DOSYALAR
â”‚       â”‚   â””â”€â”€ ...           # Drag & drop ile yuklenen dosyalar
â”‚       â”œâ”€â”€ tests/            # PROJE TESTLERI
â”‚       â”‚   â”œâ”€â”€ e2e/          # Playwright E2E testler
â”‚       â”‚   â”œâ”€â”€ unit/         # Vitest unit testler
â”‚       â”‚   â””â”€â”€ integration/  # Integration testler
â”‚       â””â”€â”€ src/              # Proje kaynak kodlari
â”‚
â”‚   NOT: memory.json YOK - Memory MCP kullaniliyor
â”‚
â”œâ”€â”€ docs/                     # Platform dokumanlari
â”‚   â”œâ”€â”€ overviews/            # Platform overview'lari
â”‚   â”œâ”€â”€ guides/               # Kullanim kilavuzlari
â”‚   â””â”€â”€ api/                  # API dokumantasyonu
â”‚
â””â”€â”€ tests/                    # Platform testleri
    â”œâ”€â”€ e2e/                  # Platform Playwright E2E testler
    â””â”€â”€ api/                  # Platform API testleri
```

---

## Storage Yapisi (File-Based)

Craft Agents gibi tum veriler dosya sisteminde saklanir:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FILE-BASED STORAGE                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚   data/                           projects/proje-adi/            â”‚
â”‚   â”œâ”€â”€ sessions/                   â”œâ”€â”€ .task/                     â”‚
â”‚   â”‚   â””â”€â”€ *.jsonl â† Mesajlar      â”œâ”€â”€ docs/                      â”‚
â”‚   â”œâ”€â”€ sources.json                â”‚   â”œâ”€â”€ v0.1.0/                â”‚
â”‚   â”œâ”€â”€ settings.json               â”‚   â”‚   â”œâ”€â”€ overview.md        â”‚
â”‚   â””â”€â”€ statuses.json               â”‚   â”‚   â”œâ”€â”€ roadmap.jsonl      â”‚
â”‚                                   â”‚   â”‚   â””â”€â”€ changelog.jsonl    â”‚
â”‚   Platform verileri               â”‚   â”œâ”€â”€ v0.2.0/                â”‚
â”‚                                   â”‚   â”‚   â””â”€â”€ ...                â”‚
â”‚                                   â”‚   â””â”€â”€ ...                    â”‚
â”‚                                   â””â”€â”€ src/                       â”‚
â”‚                                   Proje verileri                 â”‚
â”‚                                   (memory.json YOK - MCP)        â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Session JSONL Formati

Her session bir JSONL dosyasi (`data/sessions/proje-adi--v0.1.0.jsonl`):

```jsonl
{"type":"header","id":"abc123","projectId":"proje-adi","version":"v0.1.0","status":"executing","currentPhase":3,"createdAt":"2024-01-15T10:00:00Z"}
{"type":"message","role":"user","content":"Yeni versiyonda Ã¶deme sistemi ekleyelim","ts":"2024-01-15T10:01:00Z"}
{"type":"message","role":"assistant","content":"Tamam, birkaÃ§ soru sormam gerek...","ts":"2024-01-15T10:01:05Z"}
{"type":"message","role":"user","content":"Stripe olsun","ts":"2024-01-15T10:02:00Z"}
{"type":"overview","version":"v0.1.0","status":"approved","file":"docs/v0.1.0/overview.md","ts":"2024-01-15T10:05:00Z"}
{"type":"roadmap","version":"v0.1.0","status":"approved","file":"docs/v0.1.0/roadmap.jsonl","totalPhases":12,"ts":"2024-01-15T10:10:00Z"}
{"type":"phase","id":1,"name":"Stripe SDK kurulumu","status":"completed","duration":120,"ts":"2024-01-15T10:12:00Z"}
{"type":"phase","id":2,"name":"Payment service","status":"completed","duration":300,"ts":"2024-01-15T10:17:00Z"}
{"type":"phase","id":3,"name":"Checkout UI","status":"running","agent":"implementer","model":"glm","ts":"2024-01-15T10:17:30Z"}
{"type":"tool","phase":3,"name":"Write","file":"src/components/CheckoutForm.tsx","ts":"2024-01-15T10:18:00Z"}
{"type":"message","role":"user","content":"Loading spinner da ekle","ts":"2024-01-15T10:19:00Z"}
{"type":"message","role":"assistant","content":"Not aldÄ±m, faz 3'e eklenecek","ts":"2024-01-15T10:19:05Z"}
```

### Roadmap JSONL Formati

> **Kaynak:** auto.filewas roadmap yapisi

Her proje versiyonu icin `docs/vX.Y.Z/roadmap.jsonl`:

```jsonl
{"type":"header","projectName":"E-commerce App","version":"0.1.0","currentPhase":3,"totalPhases":12,"startDate":"2024-01-15","description":"MVP e-commerce uygulamasi"}
{"type":"milestone","id":1,"name":"Altyapi","phases":[1,2,3],"color":"#6366F1"}
{"type":"milestone","id":2,"name":"Backend Core","phases":[4,5,6],"color":"#8B5CF6"}
{"type":"phase","id":1,"name":"Proje kurulumu","status":"completed","description":"Monorepo, TypeScript, ESLint","startedAt":"2024-01-15T10:00:00Z","completedAt":"2024-01-15T10:30:00Z","durationMinutes":30}
{"type":"phase","id":2,"name":"Storage setup","status":"completed","description":"File-based storage, JSONL","tasks":[{"id":"2.1","title":"Session storage","status":"done"},{"id":"2.2","title":"Settings storage","status":"done"}],"acceptanceCriteria":["JSONL okuma/yazma calisir","Data persistence saglanir"],"startedAt":"2024-01-15T10:30:00Z","completedAt":"2024-01-15T11:00:00Z","durationMinutes":30}
{"type":"phase","id":3,"name":"Auth API","status":"in_progress","description":"JWT authentication","tasks":[{"id":"3.1","title":"Login endpoint","status":"in_progress"},{"id":"3.2","title":"Register endpoint","status":"pending"}],"acceptanceCriteria":["JWT token uretilir","Refresh token calÄ±sÄ±r"],"technicalNotes":["bcrypt ile hash","httpOnly cookie"]}
{"type":"phase","id":4,"name":"Product API","status":"pending","description":"CRUD endpoints","dependencies":[2,3]}
```

**Header satiri:**
```typescript
interface RoadmapHeader {
  type: 'header';
  projectName: string;
  version: string;
  currentPhase: number;
  totalPhases: number;
  startDate?: string;
  description?: string;
}
```

**Phase satiri:**
```typescript
interface PhaseEntry {
  type: 'phase';
  id: number;
  name: string;
  status: 'pending' | 'in_progress' | 'completed';
  description?: string;
  tasks?: Array<{
    id: string;
    title: string;
    status: 'pending' | 'in_progress' | 'done';
    details?: string;
  }>;
  dependencies?: number[];
  acceptanceCriteria?: string[];
  technicalNotes?: string[];
  startedAt?: string;
  completedAt?: string;
  durationMinutes?: number;
}
```

**Milestone satiri:**
```typescript
interface MilestoneEntry {
  type: 'milestone';
  id: number;
  name: string;
  phases: number[];
  color?: string;
  description?: string;
}
```

### Changelog JSONL Formati

Her proje versiyonu icin `docs/vX.Y.Z/changelog.jsonl`:

```jsonl
{"type":"header","version":"0.1.0","startDate":"2024-01-15"}
{"type":"entry","phase":1,"date":"2024-01-15","title":"Proje kurulumu tamamlandi","changes":["Monorepo yapilandirildi","TypeScript konfigurasyonu","ESLint + Prettier"],"files":["package.json","tsconfig.json",".eslintrc.js"]}
{"type":"entry","phase":2,"date":"2024-01-15","title":"Storage yapisi olusturuldu","changes":["Session storage eklendi","Settings storage eklendi","JSONL utils yazildi"],"files":["src/storage/sessions.ts","src/storage/settings.ts","src/utils/jsonl.ts"]}
{"type":"entry","phase":3,"date":"2024-01-16","title":"Auth API implement edildi","changes":["Login endpoint","Register endpoint","JWT middleware"],"files":["src/routes/auth.ts","src/middleware/auth.ts"]}
```

**Changelog entry:**
```typescript
interface ChangelogEntry {
  type: 'entry';
  phase: number;
  date: string;  // YYYY-MM-DD
  title: string;
  changes: string[];
  files: string[];
}
```

### Diger Dosya Formatlari

**Platform Dosyalari (data/):**

| Dosya | Format | Icerik |
|-------|--------|--------|
| `settings.json` | JSON | Platform ayarlari (model, fallback, permission) |
| `sources.json` | JSON | MCP, API, Local kaynak tanimlari |
| `statuses.json` | JSON | Custom session status tanimlari |

> **NOT:** Platform config dosyalari JSON kalir (append-only degil).

**Proje Versiyon Dosyalari (projects/proje-adi/docs/v0.1.0/):**

| Dosya | Format | Icerik |
|-------|--------|--------|
| `overview.md` | Markdown | Versiyon ozellikleri, gereksinimler |
| `roadmap.jsonl` | JSONL | Fazlar, gorevler, bagimliliklar (append-only) |
| `changelog.jsonl` | JSONL | Degisiklik kayitlari (append-only) |

> **NOT:** `memory.json` YOK. Memory MCP kullaniliyor - proje bilgileri entity olarak saklanir.

### Storage Avantajlari

| Avantaj | Aciklama |
|---------|----------|
| Git-friendly | Tum veriler text, diff gorunur, commit edilebilir |
| Portable | Klasoru kopyala = tum veriyi tasi |
| Human-readable | Editorle acip okuyabilirsin |
| Backup kolay | Git push = otomatik backup |
| Debug kolay | Dosyayi acip kontrol et |
| Append-only | JSONL'e yeni satir ekle = hizli yazma |

---

## Kullanim Akisi

### Uygulama Giris Akisi

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. Sifre   â”‚â”€â”€â”€â–¶â”‚  2. Proje Secim Ekrani          â”‚â”€â”€â”€â–¶â”‚  3. Chat    â”‚
â”‚   Ekrani    â”‚    â”‚     (Craft Agents tarzi)        â”‚    â”‚   Ekrani    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Proje Secim Ekrani:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      PROJE SEC                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ“ e-commerce   â”‚  â”‚ ğŸ“ mobile-app   â”‚  â”‚ ğŸ“ api-service  â”‚ â”‚
â”‚  â”‚ 12 session      â”‚  â”‚ 5 session       â”‚  â”‚ 8 session       â”‚ â”‚
â”‚  â”‚ Son: 2 saat     â”‚  â”‚ Son: 1 gun      â”‚  â”‚ Son: 3 gun      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                 â”‚
â”‚  [+ Yeni Repo Olustur]    [ğŸ“¥ Mevcut Repoyu Cek]               â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

| Secenek | Aciklama |
|---------|----------|
| **Mevcut Proje Sec** | Listeden proje sec â†’ Chat ekranina git |
| **Yeni Repo Olustur** | Sifirdan yeni proje olustur, GitHub'da repo ac |
| **Mevcut Repoyu Cek** | GitHub URL gir â†’ `projects/` klasorune clone et â†’ Projeyi kullan |

### Yeni Proje Olusturma

| Adim | Islem |
|------|-------|
| 1 | "Yeni Repo Olustur" tikla |
| 2 | Proje adi ve aciklama gir |
| 3 | Tech stack sec (veya AI tespit etsin) |
| 4 | GitHub'da repo olusturulur |
| 5 | Chat ekranina yonlendirilir |

### Mevcut Repo Import

| Adim | Islem |
|------|-------|
| 1 | "Mevcut Repoyu Cek" tikla |
| 2 | GitHub URL gir |
| 3 | Repo `projects/` altina clone edilir |
| 4 | AI projeyi analiz eder (tech stack, yapi) |
| 5 | Chat ekranina yonlendirilir |

### Quick Task

```bash
# Session ac â†’ Quick Chat sec â†’ Prompt yaz
"Auth sayfasina Google login ekle"

# AI akisi:
# 1. Anla (proje analizi)
# 2. Yap (kod yaz)
# 3. Test et (Playwright)
# 4. Goster (diff viewer)
# 5. Onay iste (Ask mode'da)
```

---

## Proje Yonetimi

| Ozellik | Aciklama |
|---------|----------|
| Sifirdan Proje | Yeni proje olusturma |
| GitHub Import | GitHub repo URL'den import |
| Local Import | Mevcut lokal proje import |
| GitHub Entegrasyonu | Her proje otomatik repo'ya baglanir |
| Tum Proje Tipleri | Web, Backend, Mobile, Fullstack, CLI |

---

---

## Gereksinimler (Prerequisites)

| Gereksinim | Versiyon | Aciklama |
|------------|----------|----------|
| Node.js | 22+ | LTS runtime |
| Claude CLI | latest | Auth yapilmis olmali (`claude auth login`) |
| Playwright | latest | E2E test framework |
| GitHub CLI (gh) | latest | Repo yonetimi |
| Git | 2.x+ | Versiyon kontrolu |

---

## Domain & Erisim

| Bilgi | Deger |
|-------|-------|
| URL | `https://task.filewas.com` |
| Platform Path | `/var/www/task.filewas/` |
| Kullanici Projeleri | `/var/www/task.filewas/projects/proje-adi/` |
| Global ECC | `/var/www/task.filewas/.task/` |
| Tek Kullanici | Sadece sen (authentication basit olabilir) |
| UI Dili | Turkce |

### CLI Komutlari (Server)

| Komut | Model | Config | Kullanim |
|-------|-------|--------|----------|
| `claude` | Opus 4.5 | `~/.claude/` | Kritik gorevler |
| `glm` | GLM 4.7 | `~/.claude-glm/` | Rutin gorevler |

**Not:** Her proje `projects/` altinda kendi klasorunde olusturulur. Proje klasorune `.task/` global dosyalari otomatik kopyalanir.

---

## API Authentication

| Bilgi | Deger |
|-------|-------|
| Auth Type | Basit Password |
| Password | `.env` dosyasindan (`API_PASSWORD`) |
| Token | Login sonrasi JWT token |
| Token Expiry | Yok (expire olmaz) |

### Login Flow

```
1. POST /api/auth/login { password: "3224" }
2. Response: { token: "jwt...", success: true }
3. Sonraki isteklerde: Authorization: Bearer <token>
```

### API Endpoints (Temel)

| Method | Endpoint | Aciklama |
|--------|----------|----------|
| POST | `/api/auth/login` | Login, token al |
| GET | `/api/health` | Health check |
| GET | `/api/projects` | Proje listesi |
| POST | `/api/projects` | Yeni proje olustur |
| GET | `/api/projects/:id` | Proje detayi |
| DELETE | `/api/projects/:id` | Proje sil |
| GET | `/api/projects/:id/sessions` | Session listesi |
| POST | `/api/projects/:id/sessions` | Yeni session |
| GET | `/api/sessions/:id` | Session detayi |
| POST | `/api/sessions/:id/messages` | Mesaj gonder |
| GET | `/api/sessions/:id/messages` | Mesaj listesi |
| POST | `/api/sessions/:id/stop` | Agent durdur |
| GET | `/api/agents` | Agent listesi |
| GET | `/api/skills` | Skill listesi |
| GET | `/api/settings` | Ayarlar |
| PUT | `/api/settings` | Ayar guncelle |

---

## Guvenlik

| Kural | Aciklama |
|-------|----------|
| API Auth | Password-based login, JWT token |
| Rate Limit | Yok (tek kullanici) |
| Credential Storage | AES-256-GCM encryption |
| Environment Variables | Hassas env vars filtrelenir |
| Permission Modes | Safe mode varsayilan |
| Plan Submission | Safe mode'da plan onay gerekli |
| Git Co-Author | `Co-Authored-By: Task.filewas <noreply@task.filewas.com>` |

---

## Basari Kriterleri (MVP - v0.1.0)

### Temel Altyapi

| Kriter | Durum |
|--------|-------|
| Craft Agents UI (3 panel, inbox) | â¬œ |
| Sifre ekrani + Proje secim ekrani | â¬œ |
| Session workflow (todo â†’ done) | â¬œ |
| Permission modes (Safe/Ask/Auto) | â¬œ |
| ECC agents/*.md parsing | â¬œ |
| Dual model (Claude + GLM) subprocess | â¬œ |
| Agent â†’ Model mapping | â¬œ |
| Thinking level â†’ Model mapping | â¬œ |
| API Authentication (password + JWT) | â¬œ |
| WebSocket realtime events | â¬œ |

### UI & Navigation

| Kriter | Durum |
|--------|-------|
| Dashboard (stats, activity, quick actions) | â¬œ |
| Sidebar navigation (7 sayfa) | â¬œ |
| Proje tabs (Sessions, Roadmap, Files, Changelog, Settings) | â¬œ |
| Settings sayfasi | â¬œ |
| Keyboard shortcuts (Craft Agents set) | â¬œ |
| Sources (MCP, API, Local) | â¬œ |
| Logs sayfasi | â¬œ |
| Agents sayfasi | â¬œ |
| Skills sayfasi | â¬œ |

### Otonom Calisma

| Kriter | Durum |
|--------|-------|
| Hybrid mode (session icinde farkli modeller) | â¬œ |
| Fallback chain (ayarlanabilir) | â¬œ |
| User override (UI'dan model secimi) | â¬œ |
| Otonom akis (Proje â†’ Test â†’ Complete) | â¬œ |
| Playwright testleri (platform + proje) | â¬œ |
| Self-healing (fail â†’ fix â†’ retry) | â¬œ |
| Context summarization | â¬œ |

### Entegrasyon

| Kriter | Durum |
|--------|-------|
| GitHub sync (auto-push) | â¬œ |
| Backup on commit | â¬œ |
| Yeni repo olusturma | â¬œ |
| Mevcut repo import | â¬œ |

---

## Risk Matrisi

| Risk | Etki | Olasilik | Azaltma |
|------|------|----------|---------|
| Claude CLI subprocess yonetimi | Yuksek | Orta | Robust error handling, timeout, retry |
| Dual model koordinasyonu | Orta | Orta | Fallback chain, model health check |
| Model rate limiting | Orta | Orta | Fallback to other model, queue |
| Model cevap tutarsizligi | Dusuk | Orta | Ayni system prompt, tutarli format |
| Paralel agent koordinasyonu | Yuksek | Orta | Iyi orchestrator tasarimi, queue |
| Test flakiness | Orta | Yuksek | Retry, isolated test environment |
| Buyuk proje context limiti | Orta | Orta | Chunking, summarization, smart retrieval |
| Session data loss | Yuksek | Dusuk | JSONL persistence, auto-save |

---

## Inject Edilen Dokumanlar

| Dokuman | Icerik | Inject Zamani |
|---------|--------|---------------|
| `overview.md` | Proje amaci, tech stack, ozellikler | Session baslangici |
| `roadmap.jsonl` | Fazlar, gorevler, milestones | Faz baslangici |

> **Memory:** Dosya olarak inject edilmiyor. Memory MCP tool'lari ile sorgulaniyor.
> Agent gerektiginde `mcp__memory__search_nodes("proje kararlari")` cagirir.

---

## Ilgili Dokumanlar

> **Not:** Bu overview **platform** icin. Proje dokumanlari `projects/proje-adi/docs/vX.Y.Z/` altinda.

| Dokuman | Konum | Icerik |
|---------|-------|--------|
| Platform Roadmap | `docs/roadmaps/v0.1.0-roadmap.jsonl` | Task.filewas faz plani |
| Platform Changelog | `docs/changelogs/v0.1.0-changelog.jsonl` | Platform degisiklik kaydi |
| Platform KurallarÄ± | `CLAUDE.md` | Global platform kurallari |

**Proje Dokumanlari (her proje icin ayri):**
| Dokuman | Konum |
|---------|-------|
| Proje Overview | `projects/proje-adi/docs/v0.1.0/overview.md` |
| Proje Roadmap | `projects/proje-adi/docs/v0.1.0/roadmap.jsonl` |
| Proje Changelog | `projects/proje-adi/docs/v0.1.0/changelog.jsonl` |

> **Memory:** Memory MCP kullaniliyor, dosya yok.

---

## Referanslar

| Kaynak | Link | Aciklama |
|--------|------|----------|
| Craft Agents OSS | https://github.com/lukilabs/craft-agents-oss | UI & mimari referans |
| Claude (Anthropic) | Anthropic Max Plan | Opus 4.5, `~/.claude/` |
| GLM (Z.AI) | Z.AI Coding Plan | GLM 4.7, `~/.claude-glm/` |
| Claude Agent SDK | Anthropic | Agent SDK |
| Everything Claude Code | `~/.claude/` | ECC sistemi |

---

<sub>Son Guncelleme: 2026-02-02 (Memory MCP, JSONL format, ECC entegrasyonu)</sub>
